<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to cleanepi • cleanepi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to cleanepi">
<meta name="robots" content="noindex">
<!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">cleanepi</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/cleanepi.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/design_principle.html">Package Design vignette for {cleanepi}</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/cleanepi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="cleanepi_files/kePrint-0.0.1/kePrint.js"></script><link href="cleanepi_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Introduction to cleanepi</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/cleanepi/blob/main/vignettes/cleanepi.Rmd" class="external-link"><code>vignettes/cleanepi.Rmd</code></a></small>
      <div class="d-none name"><code>cleanepi.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="an-overview">An overview<a class="anchor" aria-label="anchor" href="#an-overview"></a>
</h2>
<p>Data cleaning is a critical step of data analysis, especially
considering the messy nature of real-world data, which often includes
duplicates, errors, incomplete entries, irrelevant formats, etc.
Addressing these issues is essential for producing accurate, reliable,
and reproducible results. However, data cleaning can pose a substantial
barrier in data analysis due to the time-consuming nature of the
process.</p>
<p><strong>{cleanepi}</strong> is an R package designed specifically to
address this challenge by offering tools to clean, curate, and
standardize datasets. Tailored specifically for epidemiological data and
compatible with data frame-like structures, <strong>{cleanepi}</strong>
offers a suite of functions designed to streamline common data cleaning
tasks.</p>
<p>This vignette provides a comprehensive guide to the functionalities
encapsulated within <strong>{cleanepi}</strong>. It provides users with
detailed insights into each function’s purpose and practical usage,
equipping them with the tools necessary to navigate and manipulate
cluttered datasets effectively.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://epiverse-trace.github.io/cleanepi/">"cleanepi"</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="general-data-cleaning-tasks">General data cleaning tasks<a class="anchor" aria-label="anchor" href="#general-data-cleaning-tasks"></a>
</h2>
<p>The main function in <strong>{cleanepi}</strong> is
<code><a href="../reference/clean_data.html">clean_data()</a></code> that can perform the following tasks:</p>
<ol style="list-style-type: decimal">
<li>Clean up column names and convert them to more readable formats.
This includes many sub-tasks such as replacing a space, dot, or hyphen
between two words with underscore; converting camel-cases to
snake-cases; substituting foreign characters with their corresponding
English characters; and splitting a long word into multiple short words
by capital characters within, if any, and connecting them with
underscores.<br>
</li>
<li>Find and remove duplicated rows across all or some specific
columns.</li>
<li>Remove empty rows and columns as well as constant columns,
i.e. columns with the same value across all rows.<br>
</li>
<li>Replace missing entries with <code>NA</code>.</li>
<li>Standardizes date formats and verifies that the sequence of date
events follows the correct chronological order across columns for all
rows in the input data.</li>
<li>Convert <code>character</code> columns into <code>Date</code> if the
column actually contains values of type <code>Date</code> to some extent
(default is at least 60% of the values are <code>Date</code>).</li>
<li>Detect and remove rows with subject ids that do not comply with the
expected format.</li>
<li>Perform dictionary-based cleaning: replace keys in specific columns
with their corresponding values stored in a data dictionary provided as
a data frame, detect and replace misspelled values with their correct
ones.</li>
<li>Convert numbers written in characters into numeric.</li>
<li>Calculate the time span between columns or values of type Date.</li>
<li>Convert numeric values into Date.</li>
</ol>
<p>In addition, the package also has two surrogate functions:<br>
1. <code><a href="../reference/scan_data.html">scan_data()</a></code>: scan the input data to determine the
percent of missing, numeric, character, logical and date values in every
character column of the input data frame.<br>
2. <code><a href="../reference/print_report.html">print_report()</a></code>: print the data cleaning report.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IMPORTING THE TEST DATASET</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_df.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class="table  lightable-paper lightable-striped" style='font-size: 14px; font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
Dec 01, 2020
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
Jan 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
Feb 11, 2021
</td>
<td style="text-align:right;">
-99
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
Feb 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
Feb 16, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
-99
</td>
<td style="text-align:left;">
May 02, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
Feb 19, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
Sep 20, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
Feb 26, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
Mar 03, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SCAN THE DATA</span></span>
<span><span class="va">scan_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scan_data.html">scan_data</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class="table  lightable-paper lightable-striped" style='font-size: 14px; font-family: "Arial Narrow", arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Field_names
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
missing
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
numeric
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
date
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
character
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
logical
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
study_id
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
event_name
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
country_name
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
date.of.admission
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
dateOfBirth
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
date_first_pcr_positive_test
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<p>In <strong>{cleanepi}</strong>, every cleaning operation is
encapsulated within a module, with detailed descriptions provided in the
package <a href="design_principle.html">design vignette</a>. The
parameters required for the main functions of each module are outlined
in the sections below.</p>
<p>The <code><a href="../reference/clean_data.html">clean_data()</a></code> function, described above, can take the
following arguments:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: a <code>data.frame</code> or
<code>linelist</code>.</li>
<li>
<strong>standardize_column_names</strong>: a list of parameters to
be used for standardizing the column names. These arguments are the
inputs for the <code><a href="../reference/standardize_column_names.html">standardize_column_names()</a></code> function.</li>
<li>
<strong>replace_missing_values</strong>: a list of parameters to be
used when replacing the missing values by <code>NA</code>. Elements of
this list are the inputs for the <code><a href="../reference/replace_missing_values.html">replace_missing_values()</a></code>
function.</li>
<li>
<strong>remove_duplicates</strong>: a list with the arguments that
define the columns and other parameters to be considered when looking
for duplicates. They are the input values for the
<code><a href="../reference/remove_duplicates.html">remove_duplicates()</a></code> function.</li>
<li>
<strong>remove_constants</strong>: a list with the parameters that
define whether to remove constant data or not. The values are the input
for the <code><a href="../reference/remove_constants.html">remove_constants()</a></code> function.</li>
<li>
<strong>standardize_dates</strong>: a list of parameters that will
be used to standardize the date values from the input data. They
represent the input values for the <code><a href="../reference/standardize_dates.html">standardize_dates()</a></code>
function.</li>
<li>
<strong>standardize_subject_ids</strong>: a list of parameters that
are needed to check whether the subject IDs comply with the expected
format. These arguments are the input values of the
<code><a href="../reference/check_subject_ids.html">check_subject_ids()</a></code>.</li>
<li>
<strong>to_numeric</strong>: a list with the parameters needed to
convert the specified columns into numeric. When provided, the
parameters will be the input values for the
<code><a href="../reference/convert_to_numeric.html">convert_to_numeric()</a></code> function.</li>
<li>
<strong>dictionary</strong>: a data frame that will be used to
substitute the current values in the specified columns with those in the
dictionary. It is the main argument for the
<code><a href="../reference/clean_using_dictionary.html">clean_using_dictionary()</a></code> function.</li>
<li>
<strong>check_date_sequence</strong>: a list of arguments to be used
when determining whether the sequence of the target date events is
respected across all rows of the input data. The elements of this list
are the input for the <code><a href="../reference/check_date_sequence.html">check_date_sequence()</a></code> function.</li>
</ol>
<p><strong>It is important to note that only cleaning operations that
are explicitly defined will be performed.</strong></p>
<p>The below code chunk shows how to define a set of cleaning operations
that we want to perform on the input data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># PARAMETERS FOR REPLACING MISSING VALUES WITH NA</span></span>
<span><span class="va">replace_missing_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>target_columns <span class="op">=</span> <span class="cn">NULL</span>, na_strings <span class="op">=</span> <span class="st">"-99"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PARAMETERS FOR COLUMN NAMES STANDARDIZATION</span></span>
<span><span class="va">standardize_column_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>keep <span class="op">=</span> <span class="cn">NULL</span>, rename <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PARAMETERS FOR DUBLICATES DETECTION AND REMOVAL</span></span>
<span><span class="va">remove_duplicates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>target_columns <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PARAMETERS FOR STANDARDING DATES</span></span>
<span><span class="va">standardize_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  target_columns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  error_tolerance <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  format <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  timeframe <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1973-05-29"</span>, <span class="st">"2023-05-29"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  orders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    world_named_months <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ybd"</span>, <span class="st">"dby"</span><span class="op">)</span>,</span>
<span>    world_digit_months <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dmy"</span>, <span class="st">"Ymd"</span><span class="op">)</span>,</span>
<span>    US_formats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Omdy"</span>, <span class="st">"YOmd"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PARAMETERS FOR STANDARDING SUBJECT ids</span></span>
<span><span class="va">standardize_subject_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  target_columns <span class="op">=</span> <span class="st">"study_id"</span>,</span>
<span>  prefix <span class="op">=</span> <span class="st">"PS"</span>,</span>
<span>  suffix <span class="op">=</span> <span class="st">"P2"</span>,</span>
<span>  range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  nchar <span class="op">=</span> <span class="fl">7</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CONVERT THE 'sex' COLUMN INTO NUMERIC</span></span>
<span><span class="va">to_numeric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>target_columns <span class="op">=</span> <span class="st">"sex"</span>, lang <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PARAMETERS FOR CONSTANT COLUMNS, EMPTY ROWS AND COLUMNS REMOVAL</span></span>
<span><span class="va">remove_constants</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cutoff <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># LAOD THE DATA DICTIONARY FOR DICTIONARY-BASED CLEANING</span></span>
<span><span class="va">dictionary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_dictionary.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CLEAN THE INPUT DATA FRAME</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_data.html">clean_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">test_data</span>,</span>
<span>  remove_constants <span class="op">=</span> <span class="va">remove_constants</span>,</span>
<span>  replace_missing_values <span class="op">=</span> <span class="va">replace_missing_values</span>,</span>
<span>  remove_duplicates <span class="op">=</span> <span class="va">remove_duplicates</span>,</span>
<span>  standardize_dates <span class="op">=</span> <span class="va">standardize_dates</span>,</span>
<span>  standardize_subject_ids <span class="op">=</span> <span class="va">standardize_subject_ids</span>,</span>
<span>  to_numeric <span class="op">=</span> <span class="va">to_numeric</span>,</span>
<span>  dictionary <span class="op">=</span> <span class="va">dictionary</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Cleaning column names</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Replacing missing values with NA</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Removing constant columns and empty rows</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Removing duplicated rows</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> No duplicates were found.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Standardizing Date columns</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Detected <span style="color: #0000BB;">8</span> values that comply with multiple formats and <span style="color: #0000BB;">no</span> values that are</span></span>
<span><span class="co">#&gt;   outside of the specified time frame.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Enter `print_report(data = dat, "date_standardization")` to access them,</span></span>
<span><span class="co">#&gt;   where <span style="color: #0000BB;">"dat"</span> is the object used to store the output from this operation.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Checking subject IDs format</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Detected <span style="color: #0000BB;">0</span> missing, <span style="color: #0000BB;">0</span> duplicated, and <span style="color: #0000BB;">3</span> incorrect subject IDs.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Enter `print_report(data = dat, "incorrect_subject_id")` to access them,</span></span>
<span><span class="co">#&gt;   where <span style="color: #0000BB;">"dat"</span> is the object used to store the output from this operation.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> You can use the `correct_subject_ids()` function to correct them.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Converting the following  column into numeric: <span style="color: #00BB00;">sex</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Performing dictionary-based cleaning</span></span></code></pre></div>
<div class="section level3">
<h3 id="using-cleanepi-functionalities-with-pipe-operators">Using {cleanepi} functionalities with pipe operators<a class="anchor" aria-label="anchor" href="#using-cleanepi-functionalities-with-pipe-operators"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IMPORT THE INPUT DATASET</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_df.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># IMPORT THE DATA DICTIONARY</span></span>
<span><span class="va">test_dictionary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_dictionary.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># SCAN THROUGH THE DATA</span></span>
<span><span class="va">scan_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scan_data.html">scan_data</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PERFORM DATA CLEANING</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/standardize_column_names.html">standardize_column_names</a></span><span class="op">(</span>keep <span class="op">=</span> <span class="cn">NULL</span>, rename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DOB <span class="op">=</span> <span class="st">"dateOfBirth"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/replace_missing_values.html">replace_missing_values</a></span><span class="op">(</span>target_columns <span class="op">=</span> <span class="cn">NULL</span>, na_strings <span class="op">=</span> <span class="st">"-99"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/remove_constants.html">remove_constants</a></span><span class="op">(</span>cutoff <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/remove_duplicates.html">remove_duplicates</a></span><span class="op">(</span>target_columns <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/standardize_dates.html">standardize_dates</a></span><span class="op">(</span></span>
<span>    target_columns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    error_tolerance <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>    format <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    timeframe <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1973-05-29"</span>, <span class="st">"2023-05-29"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/check_subject_ids.html">check_subject_ids</a></span><span class="op">(</span></span>
<span>    target_columns <span class="op">=</span> <span class="st">"study_id"</span>,</span>
<span>    prefix <span class="op">=</span> <span class="st">"PS"</span>,</span>
<span>    suffix <span class="op">=</span> <span class="st">"P2"</span>,</span>
<span>    range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">100L</span><span class="op">)</span>,</span>
<span>    nchar <span class="op">=</span> <span class="fl">7L</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/convert_to_numeric.html">convert_to_numeric</a></span><span class="op">(</span>target_columns <span class="op">=</span> <span class="st">"sex"</span>, lang <span class="op">=</span> <span class="st">"en"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/clean_using_dictionary.html">clean_using_dictionary</a></span><span class="op">(</span>dictionary <span class="op">=</span> <span class="va">test_dictionary</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> No duplicates were found.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Detected <span style="color: #0000BB;">8</span> values that comply with multiple formats and <span style="color: #0000BB;">no</span> values that are</span></span>
<span><span class="co">#&gt;   outside of the specified time frame.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Enter `print_report(data = dat, "date_standardization")` to access them,</span></span>
<span><span class="co">#&gt;   where <span style="color: #0000BB;">"dat"</span> is the object used to store the output from this operation.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Detected <span style="color: #0000BB;">0</span> missing, <span style="color: #0000BB;">0</span> duplicated, and <span style="color: #0000BB;">3</span> incorrect subject IDs.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Enter `print_report(data = dat, "incorrect_subject_id")` to access them,</span></span>
<span><span class="co">#&gt;   where <span style="color: #0000BB;">"dat"</span> is the object used to store the output from this operation.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> You can use the `correct_subject_ids()` function to correct them.</span></span>
<span></span>
<span><span class="co"># ADD THE DATA SCANNING RESULT TO THE REPORT</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_to_report.html">add_to_report</a></span><span class="op">(</span></span>
<span>   x <span class="op">=</span> <span class="va">cleaned_data</span>,</span>
<span>   key <span class="op">=</span> <span class="st">"scanning_result"</span>,</span>
<span>   value <span class="op">=</span> <span class="va">scan_res</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="printing-the-report">Printing the report<a class="anchor" aria-label="anchor" href="#printing-the-report"></a>
</h3>
<p>It returns the cleaned dataset. The report generated from the data
cleaning operations is a <code>list object</code> that is attached to
the cleaned data and can be accessed using the <code><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr()</a></code> or
<code><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes()</a></code> function. However, we strongly advice using
the <code><a href="../reference/print_report.html">print_report()</a></code> function to either display the entire
report in your default browser in the form of an HTML file or only the
report from a specific data cleaning operation. The function takes the
following parameters:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: the output object returned from the
<code><a href="../reference/clean_data.html">clean_data()</a></code> or the main functions of each data cleaning
modules.</li>
<li>
<strong>print</strong>: a logical that specifies whether to open the
report in your browser in the form of a HTML file or no. Default is
<code>FALSE</code>.</li>
<li>
<strong>output_file_name</strong>: a character used to specify the
name of the report file, excluding any file extension. If no file name
is supplied, one will be automatically generated with the format
<code>cleanepi_report_YYMMDD_HHMMSS</code>.</li>
<li>
<strong>format</strong>: a character with the file format of the
report. Currently only <code>"html"</code> is supported.</li>
<li>
<strong>what</strong>: a character with the name of the specific
data cleaning report which would be displayed. The table below contains
the possible values of the this argument.</li>
</ol>
<table class="table">
<colgroup>
<col width="62%">
<col width="37%">
</colgroup>
<thead><tr class="header">
<th><strong>keywords</strong></th>
<th><strong>goal</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>incorrect_date_sequence</code></td>
<td>To display rows with the incorrect date sequences</td>
</tr>
<tr class="even">
<td><code>colnames</code></td>
<td>To display the column names before and after cleaning</td>
</tr>
<tr class="odd">
<td><code>converted_into_numeric</code></td>
<td>To display the names of the columns that that have</td>
</tr>
<tr class="even">
<td>been converted into numeric</td>
<td></td>
</tr>
<tr class="odd">
<td><code>date_standardization</code></td>
<td>To display rows in the cleaned data with date values</td>
</tr>
<tr class="even">
<td><code>misspelled_values</code></td>
<td>To display the detected misspelled values</td>
</tr>
<tr class="odd">
<td><code>removed_duplicates</code></td>
<td>To display the duplicated rows that have been removed</td>
</tr>
<tr class="even">
<td><code>found_duplicates</code></td>
<td>To display the duplicated rows</td>
</tr>
<tr class="odd">
<td><code>constant_data</code></td>
<td>To display the constant data i.e. constant columns, empty rows and
columns</td>
</tr>
<tr class="even">
<td><code>missing_values_replaced_at</code></td>
<td>To display the names of the columns where the missing value strings
have been replaced with NA</td>
</tr>
<tr class="odd">
<td><code>incorrect_subject_id</code></td>
<td>To display the missing, duplicated and invalid subject subject
IDs</td>
</tr>
</tbody>
</table>
<p>that are outside of the specified time frame, and rows with date
values that comply with multiple formats |</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># PRINT THE ENTIRE DATA CLEANING REPORT</span></span>
<span><span class="fu"><a href="../reference/print_report.html">print_report</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">cleaned_data</span>,</span>
<span>  what <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  print <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  report_title <span class="op">=</span> <span class="st">"{cleanepi} data cleaning report"</span>,</span>
<span>  output_file_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  format <span class="op">=</span> <span class="st">"html"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="specific-data-cleaning-tasks">Specific data cleaning tasks<a class="anchor" aria-label="anchor" href="#specific-data-cleaning-tasks"></a>
</h2>
<p><strong>{cleanepi}</strong> luckily provides users with the
flexibility to call a specific function if they wish to perform that
particular task individually. This approach allows users to have more
control over the data cleaning process and to apply additional data
cleaning functions as needed.</p>
<p>For example, some data cleaning operations, such as renaming columns,
removing empty rows and columns, removing columns with the same values
across all rows, and standardizing date columns, play a central role in
standardizing the epidemiological data. These operations can be
performed within the framework of the <code><a href="../reference/clean_data.html">clean_data()</a></code> function
or alone by calling the relevant function.</p>
<p>This setup offers users both convenience and flexibility, as they can
perform all the cleaning operations at once, or execute them
individually according to their specific needs.</p>
<div class="section level3">
<h3 id="remove-constant-data">Remove constant data<a class="anchor" aria-label="anchor" href="#remove-constant-data"></a>
</h3>
<p>Some datasets contain constant columns (columns with the same values
across all rows), and/or empty rows and columns (rows or columns where
all values are missing i.e <code>NA</code>). The
<code><a href="../reference/remove_constants.html">remove_constants()</a></code> function can be used to remove such
“noise”. The function takes the following arguments:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: the input data frame or linelist,</li>
<li>
<strong>cutoff</strong>: a numeric, between <code>0</code> and
<code>1</code>, to be used when removing empty rows and columns. When
provided, only rows and columns where the percent of missing data is
greater than this cut-off will removed. Rows and columns with 100%
missing values will be remove by default.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IMPORT THE INPUT DATA</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_df.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># INTRODUCE AN EMPTY COLUMN</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">empty_column</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># remove the constant columns, empty rows and columns</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_constants.html">remove_constants</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class="table  lightable-paper lightable-striped" style='font-size: 14px; font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
Dec 01, 2020
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
Jan 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
Feb 11, 2021
</td>
<td style="text-align:right;">
-99
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
Feb 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
Feb 16, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
-99
</td>
<td style="text-align:left;">
May 02, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
Feb 19, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
Sep 20, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
Feb 26, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
Mar 03, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
<p>The <code><a href="../reference/remove_constants.html">remove_constants()</a></code> function returns a dataset where
all constant columns, empty rows and columns are iteratively removed.
Note that when the first iteration of constant data removal results in a
dataset with new empty rows and/or columns and constant columns, this
process will be repeated several times until there is no more constant
data. Rows and columns that were deleted at any iterations will be
mentioned in the report object.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/print_report.html">print_report</a></span><span class="op">(</span><span class="va">dat</span>, <span class="st">"constant_data"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   iteration empty_columns empty_rows                       constant_columns</span></span>
<span><span class="co">#&gt; 1         1  empty_column         NA event_name, country_code, country_name</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cleaning-column-names">Cleaning column names<a class="anchor" aria-label="anchor" href="#cleaning-column-names"></a>
</h3>
<p>The syntax used to name the columns of a dataset during its creation
depends on many factors such as the language, the naming convention,
etc. We provide, in <strong>{cleanepi}</strong>, the
<code><a href="../reference/standardize_column_names.html">standardize_column_names()</a></code> function to clean up column
names and convert them to more intuitive formats. It performs many
sub-tasks including: replacing a space, dot, or hyphen between two words
with underscore; converting camel-cases to snake-cases; substituting
foreign characters with their corresponding English characters; and
splitting along word into multiple short words by capital characters
within, if any, and connecting them with underscores. The function can
take the following arguments:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: the input data frame or linelist</li>
<li>
<strong>keep</strong>: a vector of column names to maintain as they
are. When dealing with a linelist, this can be set to
<code>linelist_tags</code>, to maintain the tagged column names. The
Default is <code>NULL</code>.</li>
<li>
<strong>rename</strong>: a vector of column names to be renamed in
the form of <code>new_name = "old_name"</code>. If not provided, all
columns will undergo standardization.</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IMPORT AND PRINT THE INITAL COLUMN NAMES</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_df.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "study_id"                     "event_name"                  </span></span>
<span><span class="co">#&gt; [3] "country_code"                 "country_name"                </span></span>
<span><span class="co">#&gt; [5] "date.of.admission"            "dateOfBirth"                 </span></span>
<span><span class="co">#&gt; [7] "date_first_pcr_positive_test" "sex"</span></span>
<span></span>
<span><span class="co"># KEEP 'date.of.admission' AS IS</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/standardize_column_names.html">standardize_column_names</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  keep <span class="op">=</span> <span class="st">"date.of.admission"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">cleaned_data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "study_id"                     "event_name"                  </span></span>
<span><span class="co">#&gt; [3] "country_code"                 "country_name"                </span></span>
<span><span class="co">#&gt; [5] "date.of.admission"            "date_of_birth"               </span></span>
<span><span class="co">#&gt; [7] "date_first_pcr_positive_test" "sex"</span></span>
<span></span>
<span><span class="co"># KEEP 'date.of.admission' AS IS, BUT RENAME 'dateOfBirth' AND 'sex' TO</span></span>
<span><span class="co"># 'DOB' AND 'gender' RESPECTIVELY</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/standardize_column_names.html">standardize_column_names</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  keep <span class="op">=</span> <span class="st">"date.of.admission"</span>,</span>
<span>  rename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>DOB <span class="op">=</span> <span class="st">"dateOfBirth"</span>, gender <span class="op">=</span> <span class="st">"sex"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PRINT THE REPORT FOR THIS OPERATION</span></span>
<span><span class="fu"><a href="../reference/print_report.html">print_report</a></span><span class="op">(</span><span class="va">cleaned_data</span>, <span class="st">"colnames"</span><span class="op">)</span></span>
<span><span class="co">#&gt;                         before                        after</span></span>
<span><span class="co">#&gt; 1                     study_id                     study_id</span></span>
<span><span class="co">#&gt; 2                   event_name                   event_name</span></span>
<span><span class="co">#&gt; 3                 country_code                 country_code</span></span>
<span><span class="co">#&gt; 4                 country_name                 country_name</span></span>
<span><span class="co">#&gt; 5            date.of.admission            date.of.admission</span></span>
<span><span class="co">#&gt; 6                  dateOfBirth                          DOB</span></span>
<span><span class="co">#&gt; 7 date_first_pcr_positive_test date_first_pcr_positive_test</span></span>
<span><span class="co">#&gt; 8                          sex                       gender</span></span></code></pre></div>
<p>By providing the function with these parameters, the users can
redefine the column names and get easy to work with column names. This
enables a more comprehensive naming system that is tailored to the needs
of the user.</p>
</div>
<div class="section level3">
<h3 id="replacing-missing-entries-with-na">Replacing missing entries with <code>NA</code><a class="anchor" aria-label="anchor" href="#replacing-missing-entries-with-na"></a>
</h3>
<p>It is common to have missing values in an input dataset. By default,
R expects missing values to be represented by <code>NA</code>. However,
this is not always the case as some dataset can contain a specific
character string that denotes the missing value. In the presence of such
a scenario, users can call the <code><a href="../reference/replace_missing_values.html">replace_missing_values()</a></code>
function to substitute these missing values with <code>NA</code>. This
will make the data suitable for any data science operations. The
function takes the following arguments:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: the input data frame or linelist.</li>
<li>
<strong>target_columns</strong>: a vector of column names. If
provided, the substitution of missing values will only be executed in
those specified columns. When the input data is a <code>linelist</code>
object, this parameter can be set to <code>linelist_tags</code> if you
wish to replace missing values with <code>NA</code> on tagged columns
only. The default value is <code>NULL</code> i.e. replace missing values
across all columns.</li>
<li>
<strong>na_strings</strong>: a vector of character strings that
represents the missing values in the columns of interest. By default, it
utilizes <code><a href="../reference/common_na_strings.html">cleanepi::common_na_strings</a></code>. However, if the
missing values string in the columns of interest is not included in this
predefined vector, it can be used as the value for this argument.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># VISUALIZE THE PREDEFINED VECTOR OF MISSING CHARACTERS</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">cleanepi</span><span class="fu">::</span><span class="va"><a href="../reference/common_na_strings.html">common_na_strings</a></span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "missing"       "NA"            "N A"           "N/A"          </span></span>
<span><span class="co">#&gt;  [5] "#N/A"          "NA "           " NA"           "N /A"         </span></span>
<span><span class="co">#&gt;  [9] "N / A"         " N / A"        "N / A "        "na"           </span></span>
<span><span class="co">#&gt; [13] "n a"           "n/a"           "na "           " na"          </span></span>
<span><span class="co">#&gt; [17] "n /a"          "n / a"         " a / a"        "n / a "       </span></span>
<span><span class="co">#&gt; [21] "NULL"          "null"          ""              "\\?"          </span></span>
<span><span class="co">#&gt; [25] "\\*"           "\\."           "not available" "Not Available"</span></span>
<span><span class="co">#&gt; [29] "NOt available" "not avail"     "Not Avail"     "nan"          </span></span>
<span><span class="co">#&gt; [33] "NAN"           "not a number"  "Not A Number"</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_df.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># REPLACE ALL OCCURENCES OF "-99" WITH NA IN THE "sex" COLUMN</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/replace_missing_values.html">replace_missing_values</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>  na_strings <span class="op">=</span> <span class="st">"-99"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># REPLACE ALL OCCURENCES OF "-99" WITH NA FROM ALL COLUMNS</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/replace_missing_values.html">replace_missing_values</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na_strings <span class="op">=</span> <span class="st">"-99"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PRINT THE REPORT FROM THIS OPERATION</span></span>
<span><span class="fu"><a href="../reference/print_report.html">print_report</a></span><span class="op">(</span><span class="va">cleaned_data</span>, <span class="st">"missing_values_replaced_at"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "dateOfBirth" "sex"</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class="table  lightable-paper lightable-striped" style='font-size: 14px; font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
Dec 01, 2020
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
Jan 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
Feb 11, 2021
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
Feb 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
Feb 16, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
May 02, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
Feb 19, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
Sep 20, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
Feb 26, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
Mar 03, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="standardizing-dates">Standardizing Dates<a class="anchor" aria-label="anchor" href="#standardizing-dates"></a>
</h3>
<p>The default date format in R is <code>YYYY-MM-DD</code> (the ISO8601
format). However, it is very common to encounter date values that are
written differently from this. Also, there are cases where a column in a
data frame contains both values of type <code>Date</code>,
<code>character</code> or others.</p>
<p>The <code><a href="../reference/standardize_dates.html">standardize_dates()</a></code> function provides a
comprehensive set of options for converting date columns into a
specified format and handling various scenarios, such as different date
formats and mixed data types in a column.</p>
<p>Entries which cannot be processed result in <code>NA</code>. An error
threshold can be used to define the maximum number of resulting
<code>NA</code> (i.e. entries without an identified date) that can be
tolerated. If this threshold is exceeded, the initial values will be
returned.</p>
<p>The function expects the following arguments:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: A data frame or linelist (required).<br>
</li>
<li>
<strong>target_columns</strong>: A vector of the names of the
columns to be converted (optional). When not provided, the function will
attempt to detect date columns and perform the conversion if the
conditions above are met.</li>
<li>
<strong>format</strong>: A format of the values in the specified
columns (optional). If not provided, the function will attempt to infer
the format.</li>
<li>
<strong>timeframe</strong>: The expected time frame within which the
date values should fall. Values outside of this range will be set to
<code>NA</code> (optional).</li>
<li>
<strong>error_tolerance</strong>: The maximum percentage of
<code>NA</code> values (non date values) that can be allowed in a
converted column. Default is 40% i.e. <code>0.4</code>.</li>
<li>
<strong>orders</strong>: A character vector or list of codes for
fine-grained parsing of dates. It is used for parsing of mixed dates. If
a list is supplied, that list will be used for successive tries in
parsing. Default is:</li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">orders</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  quarter_partial_dates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="st">"Ym"</span>, <span class="st">"Yq"</span><span class="op">)</span>,</span>
<span>  world_digit_months <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ymd"</span>, <span class="st">"ydm"</span>, <span class="st">"dmy"</span>, <span class="st">"mdy"</span>, <span class="st">"myd"</span>, <span class="st">"dym"</span>, <span class="st">"Ymd"</span>, <span class="st">"Ydm"</span>,</span>
<span>                         <span class="st">"dmY"</span>, <span class="st">"mdY"</span>, <span class="st">"mYd"</span>, <span class="st">"dYm"</span><span class="op">)</span>,</span>
<span>  world_named_months <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dby"</span>, <span class="st">"dyb"</span>, <span class="st">"bdy"</span>, <span class="st">"byd"</span>, <span class="st">"ybd"</span>, <span class="st">"ydb"</span>, <span class="st">"dbY"</span>, <span class="st">"dYb"</span>,</span>
<span>                         <span class="st">"bdY"</span>, <span class="st">"bYd"</span>, <span class="st">"Ybd"</span>, <span class="st">"Ydb"</span><span class="op">)</span>,</span>
<span>  us_format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Omdy"</span>, <span class="st">"YOmd"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>⚠️ The <code>error_tolerance</code> must be used with caution. When
it is set, and the percentage of non-date values (NA i.e. values that
were not converted into date) in a character column is greater than this
threshold, the column will be returned as it is. The values outside of
this timeframe can be accessed from the report object via its
<code>date_standardization</code> element.</p>
</blockquote>
<blockquote>
<p>The value for the <code>orders</code> argument can be modified to
suit the user’s needs. Other date formats can be specified too. For
instance, if you want to prioritize American-style dates with numeric
months, you can switch the second and third elements of the default
orders as shown below:</p>
</blockquote>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># GIVE PRIORITY TO AMERICAN-STYLE DATES</span></span>
<span><span class="va">us_ord</span> <span class="op">&lt;-</span> <span class="va">orders</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">3L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># ADD A FORMAT WITH HOURS TO THE EXISTING orders</span></span>
<span><span class="co"># THIS WILL ALLOW FOR THE CONVERSION OF VALUES SUCH AS "2014_04_05_23:15:43"</span></span>
<span><span class="co"># WHEN THEY APPEAR IN THE TARGET COLUMNS.</span></span>
<span><span class="va">orders</span><span class="op">$</span><span class="va">ymdhms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ymdhms"</span>, <span class="st">"Ymdhm"</span><span class="op">)</span></span></code></pre></div>
<p>This function provides users with the flexibility to standardize date
columns in their dataset according to specified requirements, including
<code>format</code>, <code>timeframe</code>, and
<code>error tolerance</code> for conversion from character to date
columns.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># STANDARDIZE VALUES IN THE 'date.of.admission' COLUMN</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_df.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">date_first_pcr_positive_test</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Dec 01, 2020" "Jan 01, 2021" "Feb 11, 2021" "Feb 01, 2021" "Feb 16, 2021"</span></span>
<span><span class="co">#&gt; [6] "May 02, 2021"</span></span>
<span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/standardize_dates.html">standardize_dates</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">test_data</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="st">"date.of.admission"</span>,</span>
<span>  format <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  timeframe <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2021-01-01"</span>, <span class="st">"2021-12-01"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  error_tolerance <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  orders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    world_named_months <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ybd"</span>, <span class="st">"dby"</span><span class="op">)</span>,</span>
<span>    world_digit_months <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dmy"</span>, <span class="st">"Ymd"</span><span class="op">)</span>,</span>
<span>    US_formats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Omdy"</span>, <span class="st">"YOmd"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Detected <span style="color: #0000BB;">4</span> values that comply with multiple formats and <span style="color: #0000BB;">1</span> value that is</span></span>
<span><span class="co">#&gt;   outside of the specified time frame.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Enter `print_report(data = dat, "date_standardization")` to access them,</span></span>
<span><span class="co">#&gt;   where <span style="color: #0000BB;">"dat"</span> is the object used to store the output from this operation.</span></span>
<span></span>
<span><span class="co"># PRINT THE REPORT FROM THIS OPERATION</span></span>
<span><span class="fu"><a href="../reference/print_report.html">print_report</a></span><span class="op">(</span><span class="va">cleaned_data</span>, <span class="st">"date_standardization"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $multi_format_dates</span></span>
<span><span class="co">#&gt;               field idx world_named_months world_digit_months US_formats</span></span>
<span><span class="co">#&gt; 1 date.of.admission   1               &lt;NA&gt;         2020-12-01 2020-01-12</span></span>
<span><span class="co">#&gt; 2 date.of.admission   4               &lt;NA&gt;         2021-02-11 2021-11-02</span></span>
<span><span class="co">#&gt; 3 date.of.admission   9               &lt;NA&gt;         2021-03-02 2021-02-03</span></span>
<span><span class="co">#&gt; 4 date.of.admission  10               &lt;NA&gt;         2021-03-05 2021-05-03</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $out_of_range_dates</span></span>
<span><span class="co">#&gt;   idx            column original_value</span></span>
<span><span class="co">#&gt; 1   1 date.of.admission     01/12/2020</span></span></code></pre></div>
<p>This function returns the input dataset where the (specified) columns
are converted into Date if the conditions are met. The report made from
this operation contains:</p>
<ul>
<li>A data frame with the columns where date values were
standardized,</li>
<li>A data frame with the values that fall outside of the specified
timeframe,</li>
<li>A data frame featuring date values that can comply with more than
one specified format.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># STANDARDIZE VALUES IN ALL COLUMNS</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/standardize_dates.html">standardize_dates</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  format <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  timeframe <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  error_tolerance <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  orders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    world_named_months <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ybd"</span>, <span class="st">"dby"</span><span class="op">)</span>,</span>
<span>    world_digit_months <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dmy"</span>, <span class="st">"Ymd"</span><span class="op">)</span>,</span>
<span>    US_formats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Omdy"</span>, <span class="st">"YOmd"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Detected <span style="color: #0000BB;">8</span> values that comply with multiple formats and <span style="color: #0000BB;">no</span> values that are</span></span>
<span><span class="co">#&gt;   outside of the specified time frame.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Enter `print_report(data = dat, "date_standardization")` to access them,</span></span>
<span><span class="co">#&gt;   where <span style="color: #0000BB;">"dat"</span> is the object used to store the output from this operation.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Found <span style="color: #0000BB;">&lt;numeric&gt;</span> values that could also be of type <span style="color: #0000BB;">&lt;Date&gt;</span> in column:</span></span>
<span><span class="co">#&gt;   <span style="color: #00BB00;">dateOfBirth</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> It is possible to convert them into <span style="color: #0000BB;">&lt;Date&gt;</span> using: `lubridate::as_date(x,</span></span>
<span><span class="co">#&gt;   origin = as.Date("1900-01-01"))`</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> where <span style="color: #0000BB;">"x"</span> represents here the vector of values from these columns</span></span>
<span><span class="co">#&gt;   (`data$target_column`).</span></span>
<span></span>
<span><span class="co"># PRINT THE REPORT</span></span>
<span><span class="fu"><a href="../reference/print_report.html">print_report</a></span><span class="op">(</span><span class="va">cleaned_data</span>, <span class="st">"date_standardization"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $multi_format_dates</span></span>
<span><span class="co">#&gt;               field idx world_named_months world_digit_months US_formats</span></span>
<span><span class="co">#&gt; 1 date.of.admission   1               &lt;NA&gt;         2020-12-01 2020-01-12</span></span>
<span><span class="co">#&gt; 2 date.of.admission   4               &lt;NA&gt;         2021-02-11 2021-11-02</span></span>
<span><span class="co">#&gt; 3 date.of.admission   9               &lt;NA&gt;         2021-03-02 2021-02-03</span></span>
<span><span class="co">#&gt; 4 date.of.admission  10               &lt;NA&gt;         2021-03-05 2021-05-03</span></span>
<span><span class="co">#&gt; 5       dateOfBirth   1               &lt;NA&gt;         1972-01-06 1972-06-01</span></span>
<span><span class="co">#&gt; 6       dateOfBirth   7               &lt;NA&gt;         1989-03-11 1989-11-03</span></span>
<span><span class="co">#&gt; 7       dateOfBirth   8               &lt;NA&gt;         1976-05-10 1976-10-05</span></span>
<span><span class="co">#&gt; 8       dateOfBirth  10               &lt;NA&gt;         1991-08-02 1991-02-08</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class="table  lightable-paper lightable-striped" style='font-size: 14px; font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2020-12-01
</td>
<td style="text-align:left;">
1972-01-06
</td>
<td style="text-align:left;">
2020-12-01
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-01-28
</td>
<td style="text-align:left;">
1952-02-20
</td>
<td style="text-align:left;">
2021-01-01
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-15
</td>
<td style="text-align:left;">
1961-06-15
</td>
<td style="text-align:left;">
2021-02-11
</td>
<td style="text-align:right;">
-99
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-11
</td>
<td style="text-align:left;">
1947-11-11
</td>
<td style="text-align:left;">
2021-02-01
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-17
</td>
<td style="text-align:left;">
2000-09-26
</td>
<td style="text-align:left;">
2021-02-16
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-17
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2021-05-02
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-28
</td>
<td style="text-align:left;">
1989-03-11
</td>
<td style="text-align:left;">
2021-02-19
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-22
</td>
<td style="text-align:left;">
1976-05-10
</td>
<td style="text-align:left;">
2021-09-20
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-03-02
</td>
<td style="text-align:left;">
1991-09-23
</td>
<td style="text-align:left;">
2021-02-26
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-03-05
</td>
<td style="text-align:left;">
1991-08-02
</td>
<td style="text-align:left;">
2021-03-03
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="standardizing-subject-ids">Standardizing subject IDs<a class="anchor" aria-label="anchor" href="#standardizing-subject-ids"></a>
</h3>
<div class="section level4">
<h4 id="detecting-incorrect-duplicated-and-missing-subject-ids">Detecting incorrect, duplicated, and missing subject IDs<a class="anchor" aria-label="anchor" href="#detecting-incorrect-duplicated-and-missing-subject-ids"></a>
</h4>
<p>The <code><a href="../reference/check_subject_ids.html">check_subject_ids()</a></code> function is designed to identify
rows from the input dataset where the IDs don’t comply with the expected
subject IDs format. It expects the following parameters:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: A data frame or linelist (required).</li>
<li>
<strong>target_columns</strong>: The name of the column containing
the subject IDs in the dataset (required).</li>
<li>
<strong>nchar</strong>: The expected number of character in the
subject ids (optional).</li>
<li>
<strong>prefix</strong>: A string. If subject IDs have a specific
prefix, it is used as a value for this argument. This is optional and
can be omitted if there is no prefix.</li>
<li>
<strong>suffix</strong>: A string. If subject IDs have a specific
suffix, it is used as a value for this argument. It can be ignored
otherwise.</li>
<li>
<strong>range</strong>: A vector of two elements. If there is an
expected range of numbers within the subject IDs, define it using this
parameter. It is optional and can be omitted if there is no specific
range.</li>
</ol>
<p>By providing these parameters, the function becomes a versatile tool
for data cleaning, ensuring that the user is alerted on the presence of
unexpected, missing and duplicated subject IDs. When using the function,
make sure to tailor the parameters according to the specific
requirements of your dataset and the expected characteristics of the
subject IDs.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_df.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># MAKE FIRST AND LAST SUBJECT IDS THE SAME</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">study_id</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">study_id</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># SET SUBJECT ID NUMBER 9 TO NA</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">study_id</span><span class="op">[</span><span class="fl">9</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># DETECT INCORRECT SUBJECT IDs</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_subject_ids.html">check_subject_ids</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="st">"study_id"</span>,</span>
<span>  prefix <span class="op">=</span> <span class="st">"PS"</span>,</span>
<span>  suffix <span class="op">=</span> <span class="st">"P2"</span>,</span>
<span>  range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">100L</span><span class="op">)</span>,</span>
<span>  nchar <span class="op">=</span> <span class="fl">7L</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Detected <span style="color: #0000BB;">1</span> missing, <span style="color: #0000BB;">2</span> duplicated, and <span style="color: #0000BB;">2</span> incorrect subject IDs.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Enter `print_report(data = dat, "incorrect_subject_id")` to access them,</span></span>
<span><span class="co">#&gt;   where <span style="color: #0000BB;">"dat"</span> is the object used to store the output from this operation.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> You can use the `correct_subject_ids()` function to correct them.</span></span>
<span></span>
<span><span class="co"># PRINT THE REPORT FROM THIS OPERATION</span></span>
<span><span class="fu"><a href="../reference/print_report.html">print_report</a></span><span class="op">(</span><span class="va">cleaned_data</span>, <span class="st">"incorrect_subject_id"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $idx_missing_ids</span></span>
<span><span class="co">#&gt; [1] "9"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $duplicated_ids</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   study_id [1]</span></span></span>
<span><span class="co">#&gt;   row_id group_id study_id</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>      1        1 PS001P2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     10        1 PS001P2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $invalid_subject_ids</span></span>
<span><span class="co">#&gt;   idx       ids</span></span>
<span><span class="co">#&gt; 1   3 PS004P2-1</span></span>
<span><span class="co">#&gt; 2   5   P0005P2</span></span>
<span><span class="co">#&gt; 3   7   PB500P2</span></span></code></pre></div>
<p>The <code><a href="../reference/check_subject_ids.html">check_subject_ids()</a></code> function returns the input
dataset and send a warming when it finds some incorrect ids.</p>
<p>In addition to detecting undesirable subject IDs, the function will
also look for missing and duplicated IDs. As the result of this, the
report made from this operation can contain two extra elements:
<strong>missing_ids</strong> (a vector of row indexes where there is a
missing IDs) and <strong>duplicated_ids</strong> (a data frame of rows
with the duplicated IDs).</p>
</div>
<div class="section level4">
<h4 id="correct-wrong-subject-ids">Correct wrong subject ids<a class="anchor" aria-label="anchor" href="#correct-wrong-subject-ids"></a>
</h4>
<p>After the detection of the incorrect subject ids using the
<code><a href="../reference/check_subject_ids.html">check_subject_ids()</a></code>, use the
<code><a href="../reference/correct_subject_ids.html">correct_subject_ids()</a></code> to replace non complying ids with the
correct ones. The function requires a data frame with the following two
columns:</p>
<ol style="list-style-type: decimal">
<li>
<strong>from</strong>: a column with the incorrect subject ids,</li>
<li>
<strong>to</strong>: a column with the values to be used to
substitute the incorrect ids.</li>
</ol>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IMPORT THE INPUT DATA</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_df.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># GENERATE THE CORRECTION TABLE</span></span>
<span><span class="va">correction_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P0005P2"</span>, <span class="st">"PB500P2"</span>, <span class="st">"PS004P2-1"</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PB005P2"</span>, <span class="st">"PB050P2"</span>, <span class="st">"PS004P2"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PERFORM THE CORRECTION</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/correct_subject_ids.html">correct_subject_ids</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="st">"study_id"</span>,</span>
<span>  correction_table <span class="op">=</span> <span class="va">correction_table</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="checking-date-sequence">Checking date sequence<a class="anchor" aria-label="anchor" href="#checking-date-sequence"></a>
</h3>
<p>The <code><a href="../reference/check_date_sequence.html">check_date_sequence()</a></code> function verifies the order of
sequences in date event columns within a dataset. It ensures that the
values in the specified date columns follow the desired chronological
order. Here are the arguments accepted by the function:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: A data frame or linelist (required).</li>
<li>
<strong>target_columns</strong>: A vector containing the names of
the date columns of interest. These columns should be listed in the
expected order of occurrence that reflects the chronological sequence of
events. For example,
<code>target_columns = c("date_of_infection", "date_of_admission", "date_of_death")</code>.</li>
</ol>
<p>By utilizing these arguments, the <code><a href="../reference/check_date_sequence.html">check_date_sequence()</a></code>
function facilitates the validation of date sequences within a dataset,
ensuring data integrity and accuracy for further analysis. Additionally,
it offers flexibility by allowing users to choose whether to remove rows
with incorrect sequences or store them for further examination in the
report object.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IMPORT THE DATA AND STANDARDIZE THE TARGET DATE COLUMNS</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_df.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/standardize_dates.html">standardize_dates</a></span><span class="op">(</span></span>
<span>    target_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date_first_pcr_positive_test"</span>, <span class="st">"date.of.admission"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Detected <span style="color: #0000BB;">4</span> values that comply with multiple formats and <span style="color: #0000BB;">no</span> values that are</span></span>
<span><span class="co">#&gt;   outside of the specified time frame.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Enter `print_report(data = dat, "date_standardization")` to access them,</span></span>
<span><span class="co">#&gt;   where <span style="color: #0000BB;">"dat"</span> is the object used to store the output from this operation.</span></span>
<span></span>
<span><span class="co"># DETECT ROWS WITH INCORRECT DATE SEQUENCE</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/check_date_sequence.html">check_date_sequence</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date_first_pcr_positive_test"</span>, <span class="st">"date.of.admission"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Detected <span style="color: #0000BB;">2</span> incorrect date sequences at lines: <span style="color: #0000BB;">"6, 8"</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Enter `print_report(data = dat, "incorrect_date_sequence")` to access them,</span></span>
<span><span class="co">#&gt;   where <span style="color: #0000BB;">"dat"</span> is the object used to store the output from this operation.</span></span>
<span></span>
<span><span class="co"># PRINT THE REPORT FROM THIS OPERATION</span></span>
<span><span class="fu"><a href="../reference/print_report.html">print_report</a></span><span class="op">(</span><span class="va">cleaned_data</span>, <span class="st">"incorrect_date_sequence"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   date_first_pcr_positive_test date.of.admission row_id</span></span>
<span><span class="co">#&gt; 6                   2021-05-02        2021-02-17      6</span></span>
<span><span class="co">#&gt; 8                   2021-09-20        2021-02-22      8</span></span></code></pre></div>
<p>The <code><a href="../reference/check_date_sequence.html">check_date_sequence()</a></code> function returns the input
dataset, augmented with an attributes named as
<code>incorrect_date_sequence</code> if there are rows with incorrect
date sequences. This attribute highlights any discrepancies found in the
date sequences, enabling users to take appropriate actions.</p>
</div>
<div class="section level3">
<h3 id="converting-character-columns-into-numeric">Converting character columns into numeric<a class="anchor" aria-label="anchor" href="#converting-character-columns-into-numeric"></a>
</h3>
<p>In certain scenarios, the input data contains columns where the
numbers are written in letters. For instance, the ages of a study
participants can be written in letters. Similarly, a column can contain
values written in both numbers and letters (an age column where some
values are written in numbers and others in letters). The
<code><a href="../reference/convert_to_numeric.html">convert_to_numeric()</a></code> function offers the framework to
convert all numbers written in letters from a given column into numeric.
It makes call of the main function from the <a href="https://epiverse-trace.github.io/numberize/" class="external-link">{numberize}</a>
package and takes the following arguments:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: A data frame or linelist (required).</li>
<li>
<strong>target_columns</strong>: A vector containing the names of
the columns of interest. When dealing with a linelist, this can be set
to <code>linelist_tags</code> if the tagged columns are the one to be
converted into numeric. When <code>target_columns = NULL</code>, the
function uses the output form the <code><a href="../reference/scan_data.html">scan_data()</a></code> function to
identify the columns where the proportion of numeric values is at least
twice as the percentage of character values. Those columns will be the
columns of interest and the character values in them will be converted
into numeric.<br>
Note that any string in such column that can not be converted into
numeric will be set to <code>NA</code> in the resulting data.</li>
<li>
<strong>lang</strong>: A character string with the language in which
the letters are written. Currently one of
<code>"en", "fr", or "es"</code> for English, French or Spanish
respectively.</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CONVERT THE 'age' COLUMN IN THE TEST LINELIST DATA</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"messy_data.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">age</span>, <span class="fl">10L</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "37"           "seventy-four" "17"           "3"            "37"          </span></span>
<span><span class="co">#&gt;  [6] NA             "6"            "26"           "eleven"       "44"</span></span>
<span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_to_numeric.html">convert_to_numeric</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>  lang <span class="op">=</span> <span class="st">"en"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cleaned_data</span><span class="op">$</span><span class="va">age</span>, <span class="fl">10L</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 37 74 17  3 37 NA  6 26 11 44</span></span>
<span></span>
<span><span class="co"># PRINT THE REPORT FROM THIS OPERATION</span></span>
<span><span class="fu"><a href="../reference/print_report.html">print_report</a></span><span class="op">(</span><span class="va">cleaned_data</span>, <span class="st">"converted_into_numeric"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "age"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="converting-numeric-values-into-date">Converting numeric values into date<a class="anchor" aria-label="anchor" href="#converting-numeric-values-into-date"></a>
</h3>
<p>Some columns in a data frame might contain numeric values that
represents the number of days elapsed between two events. For instance,
the recruitment day of individuals in a study can be stored as a numeric
column where the numeric values are the count of days between when they
are recruited and when there were admitted in the hospital. The actual
dates when the individuals were recruited can be retrieved using the
<code><a href="../reference/convert_numeric_to_date.html">convert_numeric_to_date()</a></code> function. This function can take
the following parameters:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: the input data frame or linelist.</li>
<li>
<strong>target_columns</strong>: a vector or a comma-separated list
of columns names to be converted from numeric to date. When the input
data is a <code>linelist</code> object, this parameter can be set to
<code>linelist_tags</code> if tagged variables are the target
columns.</li>
<li>
<strong>ref_date</strong>: a reference date</li>
<li>
<strong>forward</strong>: a Boolean that indicates whether the
counts started after the reference date (<code>TRUE</code>) or not
(<code>FALSE</code>). The default is <code>TRUE</code>.</li>
</ol>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_df.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/standardize_dates.html">standardize_dates</a></span><span class="op">(</span>target_columns <span class="op">=</span> <span class="st">"date.of.admission"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Detected <span style="color: #0000BB;">4</span> values that comply with multiple formats and <span style="color: #0000BB;">no</span> values that are</span></span>
<span><span class="co">#&gt;   outside of the specified time frame.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Enter `print_report(data = dat, "date_standardization")` to access them,</span></span>
<span><span class="co">#&gt;   where <span style="color: #0000BB;">"dat"</span> is the object used to store the output from this operation.</span></span>
<span></span>
<span><span class="co"># CREATE THE RECRUITMENT DATE COLUMNS</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">recruitment_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">20</span><span class="op">:</span><span class="fl">50</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># RETRIVE THE DATE INDIVIDUALS WERE RECRUITED FROM THEIR DATE OF ADMISSION</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_numeric_to_date.html">convert_numeric_to_date</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="st">"recruitment_date"</span>,</span>
<span>  ref_date <span class="op">=</span> <span class="st">"date.of.admission"</span>,</span>
<span>  forward <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># RETRIVE THE DATE INDIVIDUALS WERE RECRUITED FROM 2019-10-13</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_numeric_to_date.html">convert_numeric_to_date</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="st">"recruitment_date"</span>,</span>
<span>  ref_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2019-10-13"</span><span class="op">)</span>,</span>
<span>  forward <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The function returns the input data where the values in the target
columns(s) are converted into Date. This enables the usage of
<strong>{cleanepi}’s</strong> functions that operates on Date columns as
well as the powerful functions that can be used to manipulate Dates from
the {base} R or {lubridate} packages.</p>
</div>
<div class="section level3">
<h3 id="finding-duplicated-rows">Finding duplicated rows<a class="anchor" aria-label="anchor" href="#finding-duplicated-rows"></a>
</h3>
<p>The <code><a href="../reference/find_duplicates.html">find_duplicates()</a></code> function serves the purpose of
identifying duplicated rows within a given dataset. It accepts the
following parameters:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: The input data frame or linelist.</li>
<li>
<strong>target_columns</strong>: A vector containing either column
names or column indices from which duplicated rows will be identified.
If <code>NULL</code> is passed, duplicates will be detected across all
columns of the dataset. Notably, if the input dataset is a
<code>linelist</code> object, <code>target_columns</code> can be set to
<code>linelist_tags</code> specifically to identify duplicates across
the tagged variables only.</li>
</ol>
<p>By leveraging the <code><a href="../reference/find_duplicates.html">find_duplicates()</a></code> function with
appropriate parameters, users can efficiently pinpoint duplicated rows
within their datasets, either across all columns or selectively across
tagged variables in a <code>linelist</code> object.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IMPORT A `linelist` DATA</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_linelist.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># SHOW THE TAGGED VARIABLES</span></span>
<span><span class="fu">linelist</span><span class="fu">::</span><span class="fu"><a href="https://epiverse-trace.github.io/linelist/reference/tags.html" class="external-link">tags</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; $date_onset</span></span>
<span><span class="co">#&gt; [1] "dt_onset"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $date_reporting</span></span>
<span><span class="co">#&gt; [1] "dt_report"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gender</span></span>
<span><span class="co">#&gt; [1] "sex"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $outcome</span></span>
<span><span class="co">#&gt; [1] "outcome"</span></span>
<span></span>
<span><span class="co"># FIND DUPLICATES ACROSS ALL COLUMNS EXCEPT THE SUBJECT ids COLUMN</span></span>
<span><span class="va">all_columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="va">target_columns</span> <span class="op">&lt;-</span> <span class="va">all_columns</span><span class="op">[</span><span class="va">all_columns</span> <span class="op">!=</span> <span class="st">"id"</span><span class="op">]</span></span>
<span><span class="va">dups</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_duplicates.html">find_duplicates</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="va">target_columns</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> No duplicates were found.</span></span>
<span></span>
<span><span class="co"># FIND DUPLICATES ACROSS TAGGED VARIABLES</span></span>
<span><span class="va">dups</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/find_duplicates.html">find_duplicates</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="st">"linelist_tags"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Found <span style="color: #0000BB;">57</span> duplicated rows in the dataset.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `print_report(dat, "found_duplicates")` to access them, where <span style="color: #0000BB;">"dat"</span> is</span></span>
<span><span class="co">#&gt;   the object used to store the output from this operation.</span></span></code></pre></div>
<p>Upon execution, the <code><a href="../reference/find_duplicates.html">find_duplicates()</a></code> function
identifies all duplicated rows either based on all columns or those
specified, and stores them in the report, where in addition to the
existing columns, it appends two extra columns to the dataset:</p>
<ol style="list-style-type: decimal">
<li>
<code>row_id</code>: Contains indices of the duplicated rows from
the original input dataset.</li>
<li>
<code>group_id</code>: Contains unique identifiers assigned to each
duplicated group, which is defined as a set of rows sharing identical
values in the designated columns of interest.</li>
</ol>
<p>By including these extra columns, users gain insights into the
specific rows identified as duplicates and their corresponding group
identifiers, enabling efficient analysis and management of duplicated
data within the dataset. When duplicates are found, the report from this
operation will contain the following elements:</p>
<ul>
<li>
<strong>duplicated_rows</strong>: A data frame with the detected
duplicates.</li>
<li>
<strong>duplicates_checked_from</strong>: A vector of column names
from which duplicates were identified.</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># PRINT THE REPORT FROM DUPLICATES FINDING</span></span>
<span><span class="fu"><a href="../reference/print_report.html">print_report</a></span><span class="op">(</span><span class="va">dups</span>, <span class="st">"found_duplicates"</span><span class="op">)</span></span>
<span><span class="co">#&gt; $duplicated_rows</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 57 × 6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   dt_onset, dt_report, sex, outcome [23]</span></span></span>
<span><span class="co">#&gt;    row_id group_id dt_onset   dt_report  sex   outcome</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     26        1 2015-05-21 2015-06-03 M     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     33        1 2015-05-21 2015-06-03 M     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     55        2 2015-05-30 2015-06-06 M     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     62        2 2015-05-30 2015-06-06 M     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     23        3 2015-05-31 2015-06-02 M     Dead   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     24        3 2015-05-31 2015-06-02 M     Dead   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     99        4 2015-05-31 2015-06-09 M     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    105        4 2015-05-31 2015-06-09 M     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     27        5 2015-06-01 2015-06-03 M     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     31        5 2015-06-01 2015-06-03 M     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 47 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $duplicates_checked_from</span></span>
<span><span class="co">#&gt; [1] "dt_onset"  "dt_report" "sex"       "outcome"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="removing-duplicates">Removing duplicates<a class="anchor" aria-label="anchor" href="#removing-duplicates"></a>
</h3>
<p>To eliminate duplicated rows from a dataset, the
<code><a href="../reference/remove_duplicates.html">remove_duplicates()</a></code> function can be employed. This function
internally utilizes the <code><a href="../reference/find_duplicates.html">find_duplicates()</a></code> function and
expects the following parameters:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: A data frame or linelist from which
duplicated rows will be removed.</li>
<li>
<strong>target_columns</strong>: A vector containing either column
names or indices specifying the columns from which duplicated rows will
be identified. If set to <code>NULL</code>, the function will remove
duplicates across all columns. If the input dataset is a
<code>linelist</code> object, setting this parameter to
<code>linelist_tags</code> will identify and remove duplicates across
the tagged variables only.</li>
</ol>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># REMOVE DUPLICATE ACROSS TAGGED COLUMNS ONLY.</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_linelist.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_duplicates.html">remove_duplicates</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_linelist.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="st">"linelist_tags"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Found <span style="color: #0000BB;">57</span> duplicated rows in the dataset.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `print_report(dat, "found_duplicates")` to access them, where <span style="color: #0000BB;">"dat"</span> is</span></span>
<span><span class="co">#&gt;   the object used to store the output from this operation.</span></span>
<span></span>
<span><span class="co"># PRINT THE REPORT FROM THIS OPERATION</span></span>
<span><span class="fu"><a href="../reference/print_report.html">print_report</a></span><span class="op">(</span><span class="va">cleaned_data</span>, <span class="st">"removed_duplicates"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 34 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   dt_onset, dt_report, sex, outcome [23]</span></span></span>
<span><span class="co">#&gt;    row_id dt_onset   dt_report  sex   outcome</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     33 2015-05-21 2015-06-03 M     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     62 2015-05-30 2015-06-06 M     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     24 2015-05-31 2015-06-02 M     Dead   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>    105 2015-05-31 2015-06-09 M     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     31 2015-06-01 2015-06-03 M     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     60 2015-06-01 2015-06-06 F     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     73 2015-06-01 2015-06-07 F     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     78 2015-06-01 2015-06-07 F     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     82 2015-06-01 2015-06-07 F     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     85 2015-06-01 2015-06-07 F     Alive  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 24 more rows</span></span></span></code></pre></div>
<p>Upon execution, the <code><a href="../reference/remove_duplicates.html">remove_duplicates()</a></code> function returns
the input dataset without duplicated rows removed (if found). The
details about the duplicates removal operation are stored in the report
object that is attached to the output object. When duplicates are found,
this report will contain the following element:</p>
<ul>
<li>
<strong>removed_duplicates</strong>: A data frame with the
duplicated rows that have been removed.</li>
</ul>
<p>By examining these elements within the report, users gain insights
into the specific duplicated rows, those that were removed, and the
columns used to identify the duplicates, thus facilitating transparency
and documentation of the duplicates removal process.</p>
</div>
<div class="section level3">
<h3 id="dictionary-based-data-substituting">Dictionary based data substituting<a class="anchor" aria-label="anchor" href="#dictionary-based-data-substituting"></a>
</h3>
<p>The <code><a href="../reference/clean_using_dictionary.html">clean_using_dictionary()</a></code> function offers a
convenient way to replace the options in a data frame or linelist with
their corresponding values stored in a data dictionary. The function
expects the following arguments:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: The input data frame or linelist that
contains the options to be replaced.</li>
<li>
<strong>dictionary</strong>: The data dictionary in a form of a data
frame that contains the complete labels for these options. The structure
of this data dictionary file should adhere to the standards expected by
the <a href="https://www.repidemicsconsortium.org/matchmaker/" class="external-link">{matchmaker}</a>
package, as the <code><a href="../reference/clean_using_dictionary.html">clean_using_dictionary()</a></code> function relies on
functions from this package.</li>
</ol>
<table class="table  lightable-paper lightable-striped" style='font-size: 14px; font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;">
options
</th>
<th style="text-align:left;">
values
</th>
<th style="text-align:left;">
grp
</th>
<th style="text-align:right;">
orders
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># READING IN THE DATA</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_df.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PERFORM THE DICTIONARY-BASED SUBSTITUTION</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_using_dictionary.html">clean_using_dictionary</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  dictionary <span class="op">=</span> <span class="va">dictionary</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Cannot replace <span style="color: #0000BB;">"-99"</span> present in column <span style="color: #00BB00;">sex</span> but not defined in the dictionary.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> You can either:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> correct the misspelled option from the input data, or</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> add it to the dictionary using the `add_to_dictionary()` function.</span></span>
<span></span>
<span><span class="co"># PRINT THE REPORT FROM THIS OPERATION</span></span>
<span><span class="fu"><a href="../reference/print_report.html">print_report</a></span><span class="op">(</span><span class="va">cleaned_data</span>, <span class="st">"misspelled_values"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   idx column value</span></span>
<span><span class="co">#&gt; 1   3    sex   -99</span></span></code></pre></div>
<p>The <code><a href="../reference/add_to_dictionary.html">add_to_dictionary()</a></code> function is a useful tool for
expanding the coverage of a data dictionary by defining options that are
present in the input data but not originally included in the dictionary.
This function enables users to dynamically update the dictionary to
accommodate new values encountered in the dataset. In addition to the
current data dictionary the function takes the arguments defined
below:</p>
<p><strong>option, value, grp, order</strong>: the values for the
options to be added in the data dictionary. The example below shows how
this function is used.</p>
<p>By employing the <code><a href="../reference/add_to_dictionary.html">add_to_dictionary()</a></code> function, users can
ensure that the data dictionary remains comprehensive and aligned with
the evolving nature of the input dataset, thereby enhancing the accuracy
and completeness of data interpretation and analysis. In the example
below, we add <code>-99</code> to our test data dictionary,
<code>test_dictionary</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ADD THE EXTRA OPTION TO THE DICTIONARY</span></span>
<span><span class="va">dictionary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_to_dictionary.html">add_to_dictionary</a></span><span class="op">(</span></span>
<span>  dictionary <span class="op">=</span> <span class="va">dictionary</span>,</span>
<span>  option <span class="op">=</span> <span class="st">"-99"</span>,</span>
<span>  value <span class="op">=</span> <span class="st">"unknow"</span>,</span>
<span>  grp <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>  order <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table  lightable-paper lightable-striped" style='font-size: 14px; font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;">
options
</th>
<th style="text-align:left;">
values
</th>
<th style="text-align:left;">
grp
</th>
<th style="text-align:right;">
orders
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
-99
</td>
<td style="text-align:left;">
unknow
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># PERFORM THE DICTIONARY-BASED SUBSTITUTION</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clean_using_dictionary.html">clean_using_dictionary</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  dictionary <span class="op">=</span> <span class="va">dictionary</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class="table  lightable-paper lightable-striped" style='font-size: 14px; font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
Dec 01, 2020
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
Jan 01, 2021
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
Feb 11, 2021
</td>
<td style="text-align:left;">
unknow
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
Feb 01, 2021
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
Feb 16, 2021
</td>
<td style="text-align:left;">
female
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
-99
</td>
<td style="text-align:left;">
May 02, 2021
</td>
<td style="text-align:left;">
female
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
Feb 19, 2021
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
Sep 20, 2021
</td>
<td style="text-align:left;">
female
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
Feb 26, 2021
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
Mar 03, 2021
</td>
<td style="text-align:left;">
female
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="correct-misspelled-values">Correct misspelled values<a class="anchor" aria-label="anchor" href="#correct-misspelled-values"></a>
</h3>
<p>The <code><a href="../reference/add_to_dictionary.html">add_to_dictionary()</a></code> function is not suitable in the
presence of a large number of misspelled values. As such, users can use
the <code><a href="../reference/correct_misspelled_values.html">correct_misspelled_values()</a></code> function to fix misspelled
values across multiple columns without needing/updating the data
dictionary. The function takes the following arguments:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: The input data frame or linelist</li>
<li>
<strong>target_columns</strong>: A vector of target columns across
which to perform the spelling checks</li>
<li>
<strong>wordlist</strong>: A vector of characters with the words to
match to the detected<br>
misspelled values</li>
<li>
<strong>max_distance</strong>: An <code>integer</code> that
represents the maximum distance allowed for detecting a spelling
mistakes from the <code>wordlist</code>. The distance is the generalized
Levenshtein edit distance. Default is <code>1</code>.</li>
<li>
<strong>confirm</strong>: A logical used to determine whether to
show the user a menu of spelling corrections. If <code>TRUE</code> and
using R interactively then the user will have the option to review the
proposed spelling corrections.</li>
</ol>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  case_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"confirmed"</span>, <span class="st">"confermed"</span>, <span class="st">"probable"</span>, <span class="st">"susspected"</span><span class="op">)</span>,</span>
<span>  outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"died"</span>, <span class="st">"recoverd"</span>, <span class="st">"did"</span>, <span class="st">"recovered"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df</span></span>
<span></span>
<span><span class="fu"><a href="../reference/correct_misspelled_values.html">correct_misspelled_values</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"case_type"</span>, <span class="st">"outcome"</span><span class="op">)</span>,</span>
<span>  wordlist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"confirmed"</span>, <span class="st">"probable"</span>, <span class="st">"suspected"</span>, <span class="st">"died"</span>, <span class="st">"recovered"</span><span class="op">)</span>,</span>
<span>  confirm <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculating-time-span-in-different-time-scales-years-months-weeks-or-days">Calculating time span in different time scales (“years”, “months”,
“weeks”, or “days”)<a class="anchor" aria-label="anchor" href="#calculating-time-span-in-different-time-scales-years-months-weeks-or-days"></a>
</h3>
<p>The <code><a href="../reference/timespan.html">timespan()</a></code> function computes the time span between
two elements of type Date. The resulting time span can be expressed in
“years”, “months”, “weeks”, or “days”, depending on the user-specified
unit. The functions can take the following arguments:</p>
<ol style="list-style-type: decimal">
<li>
<strong>data</strong>: The input dataset (required).</li>
<li>
<strong>target_column</strong>: A string with the name of the target
column (require). The values in this column are expected to be in the
form of <code>Ymd</code> i.e. <code>2024-01-31</code>. The time span
will be calculated between these values and the <code>end_date</code>
defined below.</li>
<li>
<strong>end_date</strong>: It can be either a character that is the
name of another column of type Date from the input data or a vector of
Date values or a single Date value (required). This should also be in
the ISO8601 format (“2024-01-31”) and its default value is today’s date
<code><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date()</a></code>.</li>
<li>
<strong>span_unit</strong>: This parameter determines the unit in
which the time span is expressed (required). It can be calculated in
“years”, “months”, “weeks”, or “days”. By default, the time span is
calculated in “years” if this parameter is not provided.</li>
<li>
<strong>span_column_name</strong>: A string for the name of the
column added to the input data. The default is <code>span</code>.</li>
<li>
<strong>span_remainder_unit</strong>: A parameter used to determine
the unit in which the remainder of the time span calculation will be
returned. The possible units are: “days” or “weeks” or “months”. By
default, the function returns decimal values
i.e. <code>span_remainder_unit = NULL</code>.</li>
</ol>
<p>With these arguments, the function offers flexibility in determining
the time span in different units. It facilitates various analytics tasks
where the time span computation is a necessary component, providing
users with the ability to customize the output according to their
specific requirements.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># IMPORT DATA, REPLACE MISSING VALUES WITH 'NA' &amp; STANDARDIZE DATES</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_df.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/replace_missing_values.html">replace_missing_values</a></span><span class="op">(</span></span>
<span>    target_columns <span class="op">=</span> <span class="st">"dateOfBirth"</span>,</span>
<span>    na_strings <span class="op">=</span> <span class="st">"-99"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/standardize_dates.html">standardize_dates</a></span><span class="op">(</span></span>
<span>    target_columns <span class="op">=</span> <span class="st">"dateOfBirth"</span>,</span>
<span>    error_tolerance <span class="op">=</span> <span class="fl">0.0</span>,</span>
<span>    format <span class="op">=</span> <span class="st">"%m/%d/%Y"</span> <span class="co"># nolint: nonportable_path_linter.</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The target  column will be standardized using the format: <span style="color: #0000BB;">"%m/%d/%Y"</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Detected <span style="color: #0000BB;">no</span> values that comply with multiple formats and <span style="color: #0000BB;">no</span> values that are</span></span>
<span><span class="co">#&gt;   outside of the specified time frame.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Enter `print_report(data = dat, "date_standardization")` to access them,</span></span>
<span><span class="co">#&gt;   where <span style="color: #0000BB;">"dat"</span> is the object used to store the output from this operation.</span></span>
<span></span>
<span><span class="co"># CALCULATE INDIVIDUAL AGE IN YEARS FROM THE 'dateOfBirth' COLUMN AND SEND THE</span></span>
<span><span class="co"># REMAINDER IN MONTHS</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/timespan.html">timespan</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  target_column <span class="op">=</span> <span class="st">"dateOfBirth"</span>,</span>
<span>  end_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  span_unit <span class="op">=</span> <span class="st">"years"</span>,</span>
<span>  span_column_name <span class="op">=</span> <span class="st">"age_in_years"</span>,</span>
<span>  span_remainder_unit <span class="op">=</span> <span class="st">"months"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CALCULATE THE TIME SPAN IN DAYS BETWEEN INDIVIDUALS DATE OF ADMISSION AND THE</span></span>
<span><span class="co"># DAY THEY TESTED POSITIVE</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_df.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cleaned_data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/replace_missing_values.html">replace_missing_values</a></span><span class="op">(</span></span>
<span>    target_columns <span class="op">=</span> <span class="st">"dateOfBirth"</span>,</span>
<span>    na_strings <span class="op">=</span> <span class="st">"-99"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/standardize_dates.html">standardize_dates</a></span><span class="op">(</span></span>
<span>    target_columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"date_first_pcr_positive_test"</span>, <span class="st">"date.of.admission"</span><span class="op">)</span>,</span>
<span>    error_tolerance <span class="op">=</span> <span class="fl">0.0</span>,</span>
<span>    format <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/timespan.html">timespan</a></span><span class="op">(</span></span>
<span>    target_column <span class="op">=</span> <span class="st">"date_first_pcr_positive_test"</span>,</span>
<span>    end_date <span class="op">=</span> <span class="st">"date.of.admission"</span>,</span>
<span>    span_unit <span class="op">=</span> <span class="st">"days"</span>,</span>
<span>    span_column_name <span class="op">=</span> <span class="st">"elapsed_days"</span>,</span>
<span>    span_remainder_unit <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Detected <span style="color: #0000BB;">4</span> values that comply with multiple formats and <span style="color: #0000BB;">no</span> values that are</span></span>
<span><span class="co">#&gt;   outside of the specified time frame.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Enter `print_report(data = dat, "date_standardization")` to access them,</span></span>
<span><span class="co">#&gt;   where <span style="color: #0000BB;">"dat"</span> is the object used to store the output from this operation.</span></span></code></pre></div>
<p>The <code><a href="../reference/timespan.html">timespan()</a></code> function augments the input dataset by
adding one or two extra columns containing age-related information.
These additional columns are as follows:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Calculated time span in the specified scale</strong>:
Contains the calculated time span in the specified unit (“years”,
“months”, “weeks”, or “days”).</p></li>
<li><p><strong>Remainder from the time span calculation</strong>:
Indicates the remaining number of “days” or “weeks” or “months” after
calculating the time span, representing the fractional part of the time
span calculation. This column is included if needed, and provides
additional granularity in the time span representation.</p></li>
</ol>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class="table  lightable-paper lightable-striped" style='font-size: 14px; font-family: "Arial Narrow", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
elapsed_days
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2020-12-01
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
2020-12-01
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-01-28
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
2021-01-01
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
27
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-15
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
2021-02-11
</td>
<td style="text-align:right;">
-99
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-11
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
2021-02-01
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-17
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
2021-02-16
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-17
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2021-05-02
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-74
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-28
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
2021-02-19
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-22
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
2021-09-20
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-210
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-03-02
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
2021-02-26
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-03-05
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
2021-03-03
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Karim Mané, Abdoelnaser Degoot, Bankolé Ahadzie, Nuredin Mohammed, Bubacarr Bah, data.org.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3. Theme provided by <a href="https://github.com/epiverse-trace/epiversetheme" class="external-link">epiversetheme</a> 0.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
