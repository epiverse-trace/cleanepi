<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to cleanepi</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to cleanepi</h1>



<div id="an-overview" class="section level1">
<h1>An overview</h1>
<p>Data cleaning is a critical step of data analysis, especially
considering the messy nature of real-world data, which often includes
duplicates, errors, incomplete entries, and irrelevant formats.
Addressing these issues is essential for producing accurate, reliable,
and reproducible results. However, data cleaning can pose a substantial
barrier in data analysis due to the time-consuming nature of the
process.</p>
<p><strong>{cleanepi}</strong> is an R package designed specifically to
address this challenge by offering tools to clean, curate, and
standardize datasets. Tailored specifically for epidemiological data and
compatible with data frame-like structures, <strong>{cleanepi}</strong>
offers a suite of functions designed to streamline common data cleaning
tasks.</p>
<p>This vignette provides a comprehensive guide to the functionalities
encapsulated within <strong>{cleanepi}</strong>. It provides users with
detailed insights into each function’s purpose and practical usage,
equipping them with the tools necessary to navigate and manipulate
cluttered datasets effectively.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;cleanepi&quot;</span>)</span></code></pre></div>
</div>
<div id="general-data-cleaning-tasks" class="section level1">
<h1>General data cleaning tasks</h1>
<p>The main function in <strong>{cleanepi}</strong> is
<code>clean_data()</code> that can perform the following tasks:</p>
<ol style="list-style-type: decimal">
<li>Scan the input data to determine the percent of missing, numeric,
character, logical and date values in every column of the input data
frame.</li>
<li>Clean up column names and convert them to more intuitive formats.
This includes many sub-tasks such as replacing a space, dot, or hyphen
between two words with underscore; converting camel-cases to
snake-cases; substituting foreign characters with their corresponding
English characters; and splitting a long word into multiple short words
by capital characters within, if any, and connecting them with
underscores.<br />
</li>
<li>Find and remove duplicated rows across all columns or some specific
columns.</li>
<li>Remove empty rows and columns as well as constant columns,
i.e. columns with the same value across all rows.<br />
</li>
<li>Replace missing entries with <code>NA</code>.</li>
<li>Check whether the sequence of date events are correct in all rows of
the input data.</li>
<li>Convert <code>character</code> columns into <code>Date</code> if the
column actually contains values of type <code>Date</code> to some extent
(default is at least 60% of the values are <code>Date</code>).</li>
<li>Detect and remove rows with subject IDs that do not comply with the
expected format.</li>
<li>Perform dictionary-based cleaning: replace keys in specific columns
with their corresponding values stored in a data dictionary file, and
replace misspelled values with their correct ones.</li>
<li>Convert numbers written in characters into numeric.</li>
<li>Calculate the time span between columns or values of type Date.</li>
<li>Convert numeric values into Date.</li>
<li>Print the data cleaning report.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># IMPORTING THE </span><span class="al">TEST</span><span class="co"> DATASET</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>                                 <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
Dec 01, 2020
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
Jan 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
Feb 11, 2021
</td>
<td style="text-align:right;">
-99
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
Feb 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
Feb 16, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
-99
</td>
<td style="text-align:left;">
May 02, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
Feb 19, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
Sep 20, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
Feb 26, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
Mar 03, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># SCAN THE DATA</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>scan_result <span class="ot">&lt;-</span> <span class="fu">scan_data</span>(test_data)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Field_names
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
missing
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
numeric
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
date
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
character
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
logical
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
study_id
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
event_name
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
country_code
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
country_name
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
date.of.admission
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
dateOfBirth
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
date_first_pcr_positive_test
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<p>In <strong>{cleanepi}</strong>, every cleaning operation is
encapsulated within a module, with detailed descriptions provided in the
package design vignette. Each module also specifies the parameters
required for its main function, outlined in the sections below.</p>
<p>In the following chunk, we define a list of cleaning operations that
we want to perform on the input data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># PARAMETERS FOR REPLACING MISSING VALUES WITH NA</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>rm_na <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">target_columns =</span> <span class="cn">NULL</span>, <span class="at">na_strings =</span> <span class="st">&quot;-99&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># PARAMETERS FOR COLUMN NAMES STANDARDIZATION</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>standardize_col_names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">keep =</span> <span class="cn">NULL</span>, <span class="at">rename =</span> <span class="cn">NULL</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co"># PARAMETERS FOR DUBLICATES DETECTION AND REMOVAL</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>rm_dup <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">target_columns   =</span> <span class="cn">NULL</span>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co"># PARAMETERS FOR STANDARDING DATES</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>stdn_date <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">target_columns  =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>                  <span class="at">error_tolerance =</span> <span class="fl">0.4</span>,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>                  <span class="at">format          =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>                  <span class="at">timeframe       =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;1973-05-29&quot;</span>, <span class="st">&quot;2023-05-29&quot;</span>)),</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>                  <span class="at">orders          =</span> <span class="fu">list</span>(<span class="at">world_named_months =</span> <span class="fu">c</span>(<span class="st">&quot;Ybd&quot;</span>, <span class="st">&quot;dby&quot;</span>),</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>                                         <span class="at">world_digit_months =</span> <span class="fu">c</span>(<span class="st">&quot;dmy&quot;</span>, <span class="st">&quot;Ymd&quot;</span>),</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>                                         <span class="at">US_formats       =</span> <span class="fu">c</span>(<span class="st">&quot;Omdy&quot;</span>, <span class="st">&quot;YOmd&quot;</span>)),</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>                  <span class="at">modern_excel    =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co"># PARAMETERS FOR STANDARDING SUBJECT IDs</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>stdn_ids <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">target_columns =</span> <span class="st">&quot;study_id&quot;</span>,</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>                 <span class="at">prefix         =</span> <span class="st">&quot;PS&quot;</span>,</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>                 <span class="at">suffix         =</span> <span class="st">&quot;P2&quot;</span>,</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>                 <span class="at">range          =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">100</span>),</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>                 <span class="at">nchar          =</span> <span class="dv">7</span>)</span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co"># PARAMETERS FOR CONSTANT COLUMNS, EMPTY ROWS AND COLUMNS REMOVAL</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>remove_cte <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">cutoff =</span> <span class="dv">1</span>)</span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co"># LAOD THE DATA DICTIONARY</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a>test_dictionary <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_dictionary.RDS&quot;</span>,</span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a>                                       <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="co"># DEFINE THE LIST OF PARAMETERS</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a>params <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a>  <span class="at">standardize_column_names =</span> standardize_col_names,</span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a>  <span class="at">remove_constants         =</span> remove_cte,</span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a>  <span class="at">replace_missing_values   =</span> rm_na,</span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a>  <span class="at">remove_duplicates        =</span> rm_dup,</span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a>  <span class="at">standardize_dates        =</span> stdn_date,</span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a>  <span class="at">standardize_subject_ids  =</span> stdn_ids,</span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a>  <span class="at">dictionary               =</span> test_dictionary</span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a>)</span></code></pre></div>
<p>The <code>clean_data()</code> function, as shown below, requires 2
arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: A <code>data.frame</code> or
<code>linelist</code>.</li>
<li><strong>params</strong>: A list of parameters that define the
cleaning operations to be performed.</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># CLEAN THE INPUT DATA FRAME</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> <span class="fu">clean_data</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">data   =</span> test_data,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">params =</span> params</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>cleaning column names</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>replacing missing values with <span class="cn">NA</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>removing the constant columns, empty rows and columns</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>removing duplicated rows</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>standardising date columns</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>checking subject IDs format</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>Warning<span class="sc">:</span> Detected incorrect subject ids at lines<span class="sc">:</span> <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>Use the <span class="fu">correct_subject_ids</span>() <span class="cf">function</span> to adjust them.</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>performing dictionary<span class="sc">-</span>based cleaning</span></code></pre></div>
<p>It returns the cleaned dataset. The report generated from the data
cleaning operations is a <code>list object</code> that is attached to
the cleaned data and can be accessed using the <code>attr()</code>
function. The report contains details of each cleaning operation that
was performed during the process. However, users can access the report
using the code below:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># ACCESS THE DATA CLEANING REPORT</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>report <span class="ot">&lt;-</span> <span class="fu">attr</span>(cleaned_data, <span class="st">&quot;report&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># SUMMARIZE THE REPORT OBJECT</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">summary</span>(report)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt;                            Length Class      Mode     </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; colnames                   2      data.frame list     </span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; missing_values_replaced_at 2      -none-     character</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; constant_columns           3      -none-     character</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; out_of_range_dates         3      data.frame list     </span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; multi_format_dates         5      data.frame list     </span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; incorrect_subject_id       2      data.frame list</span></span></code></pre></div>
<p>The report can also be displayed in an HTML format using the
<code>print_report()</code> function as shown below:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">print_report</span>(report)</span></code></pre></div>
</div>
<div id="specific-data-cleaning-tasks" class="section level1">
<h1>Specific data cleaning tasks</h1>
<p><strong>{cleanepi}</strong> luckily provides users with the
flexibility to call a specific function if they wish to perform that
particular task individually. This approach allows users to have more
control over the data cleaning process and to apply additional data
cleaning functions as needed.</p>
<p>For example, some data cleaning operations, such as renaming columns,
removing empty rows and columns, removing columns with the same values
across all rows, and standardizing date columns, play a central role in
standardizing the epidemiological data. These operations can be
performed within the framework of the <code>clean_data()</code> function
or alone by calling the relevant function.</p>
<p>This setup offers users both convenience and flexibility, as they can
perform all the cleaning operations at once, or execute them
individually according to their specific needs.</p>
<div id="remove-constant-data" class="section level2">
<h2>Remove constant data</h2>
<p>Some datasets contain constant columns (columns with the same values
across all rows), and/or empty rows and columns (rows or columns where
all values are missing i.e <code>NA</code>). The
<code>remove_constants()</code> function can be used to remove such
“noise”. The function takes the following argument:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: the input data frame or linelist,</li>
<li><strong>cutoff</strong>: a numeric, between <code>0</code> and
<code>1</code>, to be used when removing empty rows and columns. When
provided, only rows and columns where the percent of missing data is
greater than this cut-off will removed. Rows and columns with 100%
missing values will be remove by default.</li>
</ol>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
Dec 01, 2020
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
Jan 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
Feb 11, 2021
</td>
<td style="text-align:right;">
-99
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
Feb 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
Feb 16, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
-99
</td>
<td style="text-align:left;">
May 02, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
Feb 19, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
Sep 20, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
Feb 26, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
Mar 03, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
<p>The <code>remove_constants()</code> function returns a dataset where
all constant columns, empty rows and columns are removed.</p>
</div>
<div id="cleaning-column-names" class="section level2">
<h2>Cleaning column names</h2>
<p>The syntax used to name the columns of a dataset during its creation
depending on many factors such as the language, the naming convention,
etc. We provide, in <strong>{cleanepi}</strong>, the
<code>standardize_column_names()</code> function to clean up column
names and convert them to more intuitive formats. It performs many
sub-tasks including: replacing a space, dot, or hyphen between two words
with underscore; converting camel-cases to snake-cases; substituting
foreign characters with their corresponding English characters; and
splitting along word into multiple short words by capital characters
within, if any, and connecting them with underscores. The function can
take the following arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: the input data frame or linelist</li>
<li><strong>keep</strong>: a vector of column names to maintain as they
are. When dealing with a linelist, this can be set to
<code>linelist_tags</code>, to maintain the tagged column names. The
Default is <code>NULL</code>.</li>
<li><strong>rename</strong>: a <code>vector</code> of focal column names
and a vector of column names to be renamed in the form of
<code>new_name = &quot;old_name&quot;</code>. If not provided, all columns will
undergo standardization.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># IMPORT AND PRINT THE INITAL COLUMN NAMES</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">colnames</span>(data))</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>col_name_cleaning [<span class="dv">1</span>] <span class="st">&quot;study_id&quot;</span>                     <span class="st">&quot;event_name&quot;</span>                  </span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>col_name_cleaning [<span class="dv">3</span>] <span class="st">&quot;country_code&quot;</span>                 <span class="st">&quot;country_name&quot;</span>                </span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>col_name_cleaning [<span class="dv">5</span>] <span class="st">&quot;date.of.admission&quot;</span>            <span class="st">&quot;dateOfBirth&quot;</span>                 </span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>col_name_cleaning [<span class="dv">7</span>] <span class="st">&quot;date_first_pcr_positive_test&quot;</span> <span class="st">&quot;sex&quot;</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co"># KEEP &#39;date.of.admission&#39; AS IS</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> <span class="fu">standardize_column_names</span>(</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  <span class="at">keep =</span> <span class="st">&quot;date.of.admission&quot;</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">colnames</span>(data))</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>col_name_cleaning [<span class="dv">1</span>] <span class="st">&quot;study_id&quot;</span>                     <span class="st">&quot;event_name&quot;</span>                  </span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>col_name_cleaning [<span class="dv">3</span>] <span class="st">&quot;country_code&quot;</span>                 <span class="st">&quot;country_name&quot;</span>                </span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>col_name_cleaning [<span class="dv">5</span>] <span class="st">&quot;date.of.admission&quot;</span>            <span class="st">&quot;dateOfBirth&quot;</span>                 </span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>col_name_cleaning [<span class="dv">7</span>] <span class="st">&quot;date_first_pcr_positive_test&quot;</span> <span class="st">&quot;sex&quot;</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co"># KEEP &#39;date.of.admission&#39; AS IS, BUT RENAME &#39;dateOfBirth&#39; AND &#39;sex&#39; TO</span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co"># &#39;DOB&#39; AND &#39;gender&#39; RESPECTIVELY</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> <span class="fu">standardize_column_names</span>(</span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>  <span class="at">data   =</span> data,</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>  <span class="at">keep   =</span> <span class="st">&quot;date.of.admission&quot;</span>,</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a>  <span class="at">rename =</span> <span class="fu">c</span>(<span class="at">DOB =</span> <span class="st">&quot;dateOfBirth&quot;</span>, <span class="at">gender =</span> <span class="st">&quot;sex&quot;</span>)</span>
<span id="cb8-26"><a href="#cb8-26" tabindex="-1"></a>)</span>
<span id="cb8-27"><a href="#cb8-27" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">colnames</span>(data))</span>
<span id="cb8-28"><a href="#cb8-28" tabindex="-1"></a>col_name_cleaning [<span class="dv">1</span>] <span class="st">&quot;study_id&quot;</span>                     <span class="st">&quot;event_name&quot;</span>                  </span>
<span id="cb8-29"><a href="#cb8-29" tabindex="-1"></a>col_name_cleaning [<span class="dv">3</span>] <span class="st">&quot;country_code&quot;</span>                 <span class="st">&quot;country_name&quot;</span>                </span>
<span id="cb8-30"><a href="#cb8-30" tabindex="-1"></a>col_name_cleaning [<span class="dv">5</span>] <span class="st">&quot;date.of.admission&quot;</span>            <span class="st">&quot;dateOfBirth&quot;</span>                 </span>
<span id="cb8-31"><a href="#cb8-31" tabindex="-1"></a>col_name_cleaning [<span class="dv">7</span>] <span class="st">&quot;date_first_pcr_positive_test&quot;</span> <span class="st">&quot;sex&quot;</span></span></code></pre></div>
<p>By providing the function with these parameters, the users can
redefine the name of the columns and get easy to work with column names.
This enables a more comprehensive naming system that is tailored to the
needs of the user.</p>
</div>
<div id="replacing-missing-entries-with-na" class="section level2">
<h2>Replacing missing entries with <code>NA</code></h2>
<p>It is common to have missing values in an input dataset. By default,
R expects missing values to be represented by <code>NA</code>, However,
this is not always the case as some dataset can contain a specific
character string that denotes the missing value. In the presence of such
a scenario, user can call the <code>replace_missing_values()</code>
function to substitute these missing values with <code>NA</code>. This
will make the data suitable for any data science operations. The
function takes the following arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: the input data frame or linelist.</li>
<li><strong>target_columns</strong>: a vector of column names. If
provided, the substitution of missing values will only be executed in
those specified columns. When the input data is a <code>linelist</code>
object, this parameter can be set to <code>linelist_tags</code> if you
wish to replace missing values with <code>NA</code> on tagged columns
only. The default value <code>NULL</code> i.e. replace missing values
across all columns.</li>
<li><strong>na_strings</strong>: a vector of character strings that
represents the missing values in the columns of interest. By default, it
utilizes <code>cleanepi::common_na_strings</code>. However, if the
missing values string in the columns of interest is not included in this
predefined vector, it can be used as the value for this argument.</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># VISUALIZE THE PREDEFINED VECTOR OF MISSING CHARACTERS</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">print</span>(cleanepi<span class="sc">::</span>common_na_strings)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>default_missing_values  [<span class="dv">1</span>] <span class="st">&quot;missing&quot;</span>       <span class="st">&quot;NA&quot;</span>            <span class="st">&quot;N A&quot;</span>           <span class="st">&quot;N/A&quot;</span>          </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>default_missing_values  [<span class="dv">5</span>] <span class="st">&quot;#N/A&quot;</span>          <span class="st">&quot;NA &quot;</span>           <span class="st">&quot; NA&quot;</span>           <span class="st">&quot;N /A&quot;</span>         </span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>default_missing_values  [<span class="dv">9</span>] <span class="st">&quot;N / A&quot;</span>         <span class="st">&quot; N / A&quot;</span>        <span class="st">&quot;N / A &quot;</span>        <span class="st">&quot;na&quot;</span>           </span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>default_missing_values [<span class="dv">13</span>] <span class="st">&quot;n a&quot;</span>           <span class="st">&quot;n/a&quot;</span>           <span class="st">&quot;na &quot;</span>           <span class="st">&quot; na&quot;</span>          </span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>default_missing_values [<span class="dv">17</span>] <span class="st">&quot;n /a&quot;</span>          <span class="st">&quot;n / a&quot;</span>         <span class="st">&quot; a / a&quot;</span>        <span class="st">&quot;n / a &quot;</span>       </span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>default_missing_values [<span class="dv">21</span>] <span class="st">&quot;NULL&quot;</span>          <span class="st">&quot;null&quot;</span>          <span class="st">&quot;&quot;</span>              <span class="st">&quot;</span><span class="sc">\\</span><span class="st">?&quot;</span>          </span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>default_missing_values [<span class="dv">25</span>] <span class="st">&quot;</span><span class="sc">\\</span><span class="st">*&quot;</span>           <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>           <span class="st">&quot;not available&quot;</span> <span class="st">&quot;Not Available&quot;</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>default_missing_values [<span class="dv">29</span>] <span class="st">&quot;NOt available&quot;</span> <span class="st">&quot;not avail&quot;</span>     <span class="st">&quot;Not Avail&quot;</span>     <span class="st">&quot;nan&quot;</span>          </span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>default_missing_values [<span class="dv">33</span>] <span class="st">&quot;NAN&quot;</span>           <span class="st">&quot;not a number&quot;</span>  <span class="st">&quot;Not A Number&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># REPLACE ALL OCCURENCES OF &quot;-99&quot; WITH NA IN THE &quot;sex&quot; COLUMN</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> <span class="fu">replace_missing_values</span>(</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  <span class="at">data           =</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                                       <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)),</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;sex&quot;</span>,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="at">na_strings     =</span> <span class="st">&quot;-99&quot;</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co"># REPLACE ALL OCCURENCES OF &quot;-99&quot; WITH NA FROM ALL COLUMNS</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> <span class="fu">replace_missing_values</span>(</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  <span class="at">data           =</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>                                       <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)),</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="cn">NULL</span>,</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>  <span class="at">na_strings     =</span> <span class="st">&quot;-99&quot;</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
Dec 01, 2020
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
Jan 01, 2021
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
Feb 11, 2021
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
Feb 01, 2021
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
Feb 16, 2021
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
May 02, 2021
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
Feb 19, 2021
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
Sep 20, 2021
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
Feb 26, 2021
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
Mar 03, 2021
</td>
<td style="text-align:left;">
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="standardizing-dates" class="section level2">
<h2>Standardizing Dates</h2>
<p>The default date format in R is <code>Ymd</code> (the ISO8601
format). However, it is very common to encounter date values that are
written differently from this. Also, there are cases where a column in a
data frame contains both values of type <code>Date</code>,
<code>character</code> or others.</p>
<p>The <code>standardize_dates()</code> function provides a
comprehensive set of options for converting date columns into a
specified format and handling various scenarios, such as different date
formats and mixed data types in a column.</p>
<p>Entries which cannot be processed result in <code>NA</code>. An error
threshold can be used to define the maximum number of resulting
<code>NA</code> (i.e. entries without an identified date) that can be
tolerated. If this threshold is exceeded, the original vector is
returned.</p>
<p>The function expects the following arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: A data frame or linelist (required).<br />
</li>
<li><strong>target_columns</strong>: A vector of the names of the
columns to be converted (optional). When not provided, the function will
attempt to detect date columns and perform the conversion if
needed.</li>
<li><strong>format</strong>: A format of the values in the specified
columns (optional). If not provided, the function will attempt to infer
the format.</li>
<li><strong>timeframe</strong>: The expected time frame within which the
date values should fall. Values outside of this range will be set to
<code>NA</code> (optional).</li>
<li><strong>error_tolerance</strong>: The maximum percentage of
<code>NA</code> values (non date values) that can be allowed in a
converted column. Default is 40% i.e. <code>0.4</code>.</li>
<li><strong>orders</strong>: The date codes for fine-grained parsing of
dates. It is used for parsing of mixed dates. If a list is supplied,
that list will be used for successive tries in parsing. Default is:</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>orders <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="at">world_named_months =</span> <span class="fu">c</span>(<span class="st">&quot;Ybd&quot;</span>, <span class="st">&quot;dby&quot;</span>),</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="at">world_digit_months =</span> <span class="fu">c</span>(<span class="st">&quot;dmy&quot;</span>, <span class="st">&quot;Ymd&quot;</span>),</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="at">US_formats         =</span> <span class="fu">c</span>(<span class="st">&quot;Omdy&quot;</span>, <span class="st">&quot;YOmd&quot;</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>)</span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li><strong>modern_excel</strong>: A Boolean that determines whether all
numeric values represent dates from either a Windows version of Excel or
a 2011 or later version of Excel for OSX. Set this parameter to
<code>FALSE</code> if the data came from an OSX version of Excel before
2011. This is only relevant when parsing dates from excel. Default is
<code>TRUE</code>.</li>
</ol>
<blockquote>
<p>⚠️ The <code>error_tolerance</code> must be used with caution. When
it is set, and the percentage of non-date values (NA i.e. values that
were not converted into date) in a character column is greater than this
threshold, the column will be returned as it is.</p>
</blockquote>
<blockquote>
<p>The value for the <code>orders</code> argument can be modified to
suit the user’s needs. Other date formats can be specified too. For
instance, if you want to prioritize American-style dates with numeric
months, you can switch the second and third elements of the default
orders as shown below:</p>
</blockquote>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># GIVE PRIORITY TO AMERICAN-STYLE DATES</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>us_ord <span class="ot">&lt;-</span> orders[<span class="fu">c</span>(<span class="dv">1</span><span class="dt">L</span>, <span class="dv">3</span><span class="dt">L</span>, <span class="dv">2</span><span class="dt">L</span>)]</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># ADD A FORMAT WITH HOURS TO THE EXISTING orders</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># THIS WILL ALLOW FOR THE CONVERSION OF VALUES SUCH AS &quot;2014_04_05_23:15:43&quot;</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co"># WHEN THEY APPEAR IN THE TARGET COLUMNS.</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>orders<span class="sc">$</span>ymdhms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Ymdhms&quot;</span>, <span class="st">&quot;Ymdhm&quot;</span>)</span></code></pre></div>
<p>This function provides users with the flexibility to standardize date
columns in their dataset according to specified requirements, including
format, timeframe, and error tolerance for conversion from character to
date columns.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># STANDARDIZE VALUES IN THE &#39;date_first_pcr_positive_test&#39; COLUMN</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>,</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>                                 <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">head</span>(test_data<span class="sc">$</span>date_first_pcr_positive_test)</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>date_standardisation [<span class="dv">1</span>] <span class="st">&quot;Dec 01, 2020&quot;</span> <span class="st">&quot;Jan 01, 2021&quot;</span> <span class="st">&quot;Feb 11, 2021&quot;</span> <span class="st">&quot;Feb 01, 2021&quot;</span> <span class="st">&quot;Feb 16, 2021&quot;</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>date_standardisation [<span class="dv">6</span>] <span class="st">&quot;May 02, 2021&quot;</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">standardize_dates</span>(</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  <span class="at">data            =</span> test_data,</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>  <span class="at">target_columns  =</span> <span class="st">&quot;date_first_pcr_positive_test&quot;</span>,</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>  <span class="at">format          =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>  <span class="at">timeframe       =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>  <span class="at">error_tolerance =</span> <span class="fl">0.4</span>,</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>  <span class="at">orders          =</span> <span class="fu">list</span>(<span class="at">world_named_months =</span> <span class="fu">c</span>(<span class="st">&quot;Ybd&quot;</span>, <span class="st">&quot;dby&quot;</span>),</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>                         <span class="at">world_digit_months =</span> <span class="fu">c</span>(<span class="st">&quot;dmy&quot;</span>, <span class="st">&quot;Ymd&quot;</span>),</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>                         <span class="at">US_formats         =</span> <span class="fu">c</span>(<span class="st">&quot;Omdy&quot;</span>, <span class="st">&quot;YOmd&quot;</span>)),</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>  <span class="at">modern_excel    =</span> <span class="cn">TRUE</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>)</span></code></pre></div>
<p>This function returns the input dataset where the (specified) columns
are converted into Date if the condition is met.</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
2020-12-01
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
2021-01-01
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
2021-02-11
</td>
<td style="text-align:right;">
-99
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
2021-02-01
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
2021-02-16
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
-99
</td>
<td style="text-align:left;">
2021-05-02
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
2021-02-19
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
2021-09-20
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
2021-02-26
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
2021-03-03
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
<p>It also adds two or three elements to the report object:</p>
<ul>
<li>A data frame with the columns where date values were
standardized,</li>
<li>A data frame with the values that fall outside of the specified
timeframe,</li>
<li>A data frame featuring date values that can comply with more than
one specified format.</li>
</ul>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
field
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
idx
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
world_named_months
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
world_digit_months
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
US_formats
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
date.of.admission
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2020-12-01
</td>
<td style="text-align:left;">
2020-01-12
</td>
</tr>
<tr>
<td style="text-align:left;">
date.of.admission
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2021-02-11
</td>
<td style="text-align:left;">
2021-11-02
</td>
</tr>
<tr>
<td style="text-align:left;">
date.of.admission
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2021-03-02
</td>
<td style="text-align:left;">
2021-02-03
</td>
</tr>
<tr>
<td style="text-align:left;">
date.of.admission
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2021-03-05
</td>
<td style="text-align:left;">
2021-05-03
</td>
</tr>
<tr>
<td style="text-align:left;">
dateOfBirth
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1972-01-06
</td>
<td style="text-align:left;">
1972-06-01
</td>
</tr>
<tr>
<td style="text-align:left;">
dateOfBirth
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1989-03-11
</td>
<td style="text-align:left;">
1989-11-03
</td>
</tr>
<tr>
<td style="text-align:left;">
dateOfBirth
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1976-05-10
</td>
<td style="text-align:left;">
1976-10-05
</td>
</tr>
<tr>
<td style="text-align:left;">
dateOfBirth
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1991-08-02
</td>
<td style="text-align:left;">
1991-02-08
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="standardizing-subject-ids" class="section level2">
<h2>Standardizing subject IDs</h2>
<div id="detecting-and-remove-incorrect-subject-ids" class="section level3">
<h3>Detecting and remove incorrect subject ids</h3>
<p>The <code>check_subject_ids()</code> function is designed to identify
rows from the input dataset where the ids don’t comply with the expected
subject ids format. It expects the following parameters:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: A data frame or linelist (required).</li>
<li><strong>target_columns</strong>: The name of the column containing
the subject IDs in the dataset (required).</li>
<li><strong>nchar</strong>: The expected number of character in the
subject ids (optional).</li>
<li><strong>prefix</strong>: A string. If subject IDs have a specific
prefix, it is used as a value for this argument. This is optional and
can be omitted if there is no prefix.</li>
<li><strong>suffix</strong>: A string. If subject IDs have a specific
suffix, it is used as a value for this argument. It can be ignored
otherwise.</li>
<li><strong>range</strong>: A vector of two elements. If there is an
expected range of numbers within the subject IDs, define it using this
parameter. It is optional and can be omitted if there is no specific
range.</li>
<li><strong>remove</strong>: A logical that determines whether to remove
the incorrect subject IDs or not. By default, the wrong ids are detected
and reported. To replace these, use the
<code>correct_subject_ids()</code> function described below.</li>
</ol>
<p>By providing these parameters, the function becomes a versatile tool
for data cleaning, ensuring that the user is alerted on the presence of
unexpected, missing and duplicated subject ids. When using the function,
make sure to tailor the parameters according to the specific
requirements of your dataset and the expected characteristics of the
subject IDs.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># DETECT AND REMOVE INCORRECT SUBJECT IDs</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">check_subject_ids</span>(</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="at">data           =</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>,</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                                       <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)),</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;study_id&quot;</span>,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>  <span class="at">prefix         =</span> <span class="st">&quot;PS&quot;</span>,</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  <span class="at">suffix         =</span> <span class="st">&quot;P2&quot;</span>,</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  <span class="at">range          =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="dt">L</span>, <span class="dv">100</span><span class="dt">L</span>),</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  <span class="at">nchar          =</span> <span class="dv">7</span><span class="dt">L</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>)</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>subject_ids_standardisation Warning<span class="sc">:</span> Detected incorrect subject ids at lines<span class="sc">:</span> <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>subject_ids_standardisation Use the <span class="fu">correct_subject_ids</span>() <span class="cf">function</span> to adjust them.</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co"># EXTRACT REPORT</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>report <span class="ot">&lt;-</span> <span class="fu">attr</span>(res, <span class="st">&quot;report&quot;</span>)</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co"># SUMMARIZE THE REPORT OBJECT</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="fu">summary</span>(report)</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>subject_ids_standardisation                      Length Class      Mode</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>subject_ids_standardisation incorrect_subject_id <span class="dv">2</span>      data.frame list</span></code></pre></div>
<p>The <code>check_subject_ids()</code> function returns the input
dataset and send a warming when there are some incorrect ids.</p>
<p>In addition to detecting undesirable subject ids, the function will
also look for missing and duplicated IDs. As the result of this, the
report made from this operation might contain two extra elements:
<strong>missing_ids</strong> (a vector of row indexes where there is a
missing IDs) and <strong>duplicated_ids</strong> (a data frame of rows
with the duplicated IDs). Use the <code>print_report()</code> function
to display the report made from this operation.</p>
</div>
<div id="correct-wrong-subject-ids" class="section level3">
<h3>Correct wrong subject ids</h3>
<p>After the detection of the incorrect subject ids using the
<code>check_subject_ids()</code>, use the
<code>correct_subject_ids()</code> to replace non complying ids with the
correct ones. The function requires a data frame with the following two
columns:</p>
<ol style="list-style-type: decimal">
<li><strong>from</strong>: a column with the incorrect subject ids,</li>
<li><strong>to</strong>: a column with the values to be used to
substitute the incorrect ids.</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># IMPORT THE INPUT DATA</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co"># GENERATE THE CORRECTION TABLE</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>correction_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;P0005P2&quot;</span>, <span class="st">&quot;PB500P2&quot;</span>, <span class="st">&quot;PS004P2-1&quot;</span>),</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="at">to   =</span> <span class="fu">c</span>(<span class="st">&quot;PB005P2&quot;</span>, <span class="st">&quot;PB050P2&quot;</span>, <span class="st">&quot;PS004P2&quot;</span>),</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>)</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co"># PERFORM THE CORRECTION</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">correct_subject_ids</span>(</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>  <span class="at">data             =</span> data,</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a>  <span class="at">target_columns   =</span> <span class="st">&quot;study_id&quot;</span>,</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>  <span class="at">correction_table =</span> correction_table</span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="checking-date-sequence" class="section level2">
<h2>Checking date sequence</h2>
<p>The <code>check_date_sequence()</code> function verifies the order of
sequences in date event columns within a dataset. It ensures that the
values in the specified date columns follow the desired chronological
order. Here are the arguments accepted by the function:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: A data frame or linelist (required).</li>
<li><strong>target_columns</strong>: A vector containing the names of
the date columns of interest. These columns should be listed in the
expected order of occurrence, reflecting the chronological sequence of
events. For example,
<code>target_columns = c(&quot;date_of_infection&quot;, &quot;date_of_admission&quot;, &quot;date_of_death&quot;)</code>.</li>
</ol>
<p>By utilizing these arguments, the <code>check_date_sequence()</code>
function facilitates the validation of date sequences within a dataset,
ensuring data integrity and accuracy for further analysis. Additionally,
it offers flexibility by allowing users to choose whether to remove rows
with incorrect sequences or store them for further examination in the
report object.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># DETECT ROWS WITH INCORRECT DATE SEQUENCE</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">check_date_sequence</span>(</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="at">data           =</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>                                       <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)),</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="fu">c</span>(<span class="st">&quot;date_first_pcr_positive_test&quot;</span>, <span class="st">&quot;date.of.admission&quot;</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>check_date_order Warning<span class="sc">:</span> Detected <span class="dv">10</span> incorrect date sequences at <span class="fu">line</span>(s)<span class="sc">:</span> <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>,</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>check_date_order <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co"># EXTRACT THE REPORT</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>report <span class="ot">&lt;-</span> <span class="fu">attr</span>(res, <span class="st">&quot;report&quot;</span>)</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co"># SUMMARIZE THE REPORT OBJECT</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="fu">summary</span>(report)</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>check_date_order                         Length Class      Mode</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>check_date_order incorrect_date_sequence <span class="dv">2</span>      data.table list</span></code></pre></div>
<p>The <code>check_date_sequence()</code> function returns the input
dataset, augmented with an attributes named as
<code>incorrect_date_sequence</code> if there are rows with incorrect
date sequences. This attribute highlights any discrepancies found in the
date sequences, enabling users to take appropriate actions. Use the
<code>print_report()</code> function to display the report made from
this operation.</p>
</div>
<div id="converting-character-columns-into-numeric" class="section level2">
<h2>Converting character columns into numeric</h2>
<p>In certain scenarios, the input data contains columns where the
number are written in letters. For instance, the ages of a study
participants can be written in letters. Similarly, a column can contain
values written in both numbers and letters (an age column where some
values are written in numbers and others in letters). The
<code>convert_to_numeric()</code> function offers the framework to
convert all numbers written in letters from a given column into numeric.
It takes the following arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: A data frame or linelist (required).</li>
<li><strong>target_columns</strong>: A vector containing the names of
the columns of interest. When dealing with a linelist, this can be set
to <code>linelist_tags</code> if the tagged columns are the one to be
converted into numeric. When <code>target_columns = NULL</code>, the
function uses the output form the <code>scan_data()</code> function to
identify the columns where the proportion of numeric values is at least
twice as the percentage of character values. Those columns will be the
columns of interest and the character values in them will be converted
into numeric. Note that any string in such column that can not be
converted into numeric will be set to <code>NA</code> in the resulting
data.</li>
<li><strong>lang</strong>: A character string with language to be used
when performing the conversion. Currently one of
<code>&quot;en&quot;, &quot;fr&quot;, or &quot;es&quot;</code>.</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># CONVERT THE &#39;age&#39; COLUMN IN THE </span><span class="al">TEST</span><span class="co"> LINELIST DATA</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;messy_data.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">head</span>(dat<span class="sc">$</span>age, <span class="dv">10</span><span class="dt">L</span>)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>check_date_order  [<span class="dv">1</span>] <span class="st">&quot;37&quot;</span>           <span class="st">&quot;seventy-four&quot;</span> <span class="st">&quot;17&quot;</span>           <span class="st">&quot;3&quot;</span>            <span class="st">&quot;37&quot;</span>          </span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>check_date_order  [<span class="dv">6</span>] <span class="cn">NA</span>             <span class="st">&quot;6&quot;</span>            <span class="st">&quot;26&quot;</span>           <span class="st">&quot;eleven&quot;</span>       <span class="st">&quot;44&quot;</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">convert_to_numeric</span>(dat, <span class="at">target_columns =</span> <span class="st">&quot;age&quot;</span>, <span class="at">lang =</span> <span class="st">&quot;en&quot;</span>)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="fu">head</span>(dat<span class="sc">$</span>age, <span class="dv">10</span><span class="dt">L</span>)</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>check_date_order  [<span class="dv">1</span>] <span class="dv">37</span> <span class="dv">74</span> <span class="dv">17</span>  <span class="dv">3</span> <span class="dv">37</span> <span class="cn">NA</span>  <span class="dv">6</span> <span class="dv">26</span> <span class="dv">11</span> <span class="dv">44</span></span></code></pre></div>
</div>
<div id="converting-numeric-values-into-date" class="section level2">
<h2>Converting numeric values into date</h2>
<p>Some columns in a data frame might contain numeric values that
represents the number of days elapsed between two events. For instance,
the recruitment day of individuals in a study can be stored as a numeric
column where the numeric values are the count of days between when they
are recruited and when there were admitted in the hospital. The actual
dates when the individuals were recruited can be retrieved using the
<code>convert_numeric_to_date()</code> function. This function can take
the following parameters:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: the input data frame or linelist.</li>
<li><strong>target_columns</strong>: a vector or a comma-separated list
of columns names to be converted from numeric to date. When the input
data is a <code>linelist</code> object, this parameter can be set to
<code>linelist_tags</code> if tagged variables are the target
columns.</li>
<li><strong>ref_date</strong>: a reference date</li>
<li><strong>forward</strong>: a Boolean that indicates whether the
counts started after the reference date (<code>TRUE</code>) or not
(<code>FALSE</code>). The default is <code>TRUE</code>.</li>
</ol>
<pre reval="TRUE," comment="convert_numeric_to_date"><code>data &lt;- readRDS(system.file(&quot;extdata&quot;, &quot;test_df.RDS&quot;, package = &quot;cleanepi&quot;)) |&gt;
  standardize_dates(target_columns = &quot;date.of.admission&quot;)

# CREATE THE RECRUITMENT DATE COLUMNS
data$recruitment_date &lt;- sample(20:50, nrow(data), replace = FALSE)

# RETRIVE THE DATE INDIVIDUALS WERE RECRUITED
data &lt;- convert_numeric_to_date(
  data           = data,
  target_columns = &quot;recruitment_date&quot;,
  ref_date       = &quot;date.of.admission&quot;,
  forward        = TRUE
)

# RETRIVE THE DATE INDIVIDUALS WERE RECRUITED
data &lt;- convert_numeric_to_date(
  data           = data,
  target_columns = &quot;recruitment_date&quot;,
  ref_date       = as.Date(&quot;2019-10-13&quot;),
  forward        = FALSE
)</code></pre>
<p>The function returns the input data where the values in the target
columns(s) are converted into Date. This enables the usage of
<strong>{cleanepi}’s</strong> functions that operates on Date columns as
well as the powerful functions that can be used to manipulate Dates from
the {base} R or {lubridate} packages.</p>
</div>
<div id="finding-duplicated-rows" class="section level2">
<h2>Finding duplicated rows</h2>
<p>The <code>find_duplicates()</code> function serves the purpose of
identifying duplicated rows within a given dataset. It accepts the
following parameters:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: The input data frame or linelist.</li>
<li><strong>target_columns</strong>: A vector containing either column
names or column indices from which duplicated rows will be identified.
If <code>NULL</code> is passed, duplicates will be detected across all
columns of the dataset. Notably, if the input dataset is a
<code>linelist</code> object, <code>target_columns</code> can be set to
<code>linelist_tags</code> specifically to identify duplicates across
the tagged variables only.</li>
</ol>
<p>By leveraging the <code>find_duplicates()</code> function with
appropriate parameters, users can efficiently pinpoint duplicated rows
within their datasets, either across all columns or selectively across
tagged variables in a <code>linelist</code> object.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># IMPORT A `linelist` DATA</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_linelist.RDS&quot;</span>,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>                            <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co"># SHOW THE TAGGED VARIABLES</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>linelist<span class="sc">::</span><span class="fu">tags</span>(data)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a><span class="sc">$</span>date_onset</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;dt_onset&quot;</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a><span class="sc">$</span>date_reporting</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;dt_report&quot;</span></span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a><span class="sc">$</span>gender</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;sex&quot;</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a></span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a><span class="sc">$</span>outcome</span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;outcome&quot;</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a><span class="co"># FIND DUPLICATES ACROSS ALL COLUMNS EXCEPT THE SUBJECT IDs COLUMN</span></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a>all_columns    <span class="ot">&lt;-</span> <span class="fu">names</span>(data)</span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a>target_columns <span class="ot">&lt;-</span> all_columns[all_columns <span class="sc">!=</span> <span class="st">&quot;id&quot;</span>]</span>
<span id="cb19-22"><a href="#cb19-22" tabindex="-1"></a>dups           <span class="ot">&lt;-</span> <span class="fu">find_duplicates</span>(<span class="at">data           =</span> data,</span>
<span id="cb19-23"><a href="#cb19-23" tabindex="-1"></a>                                  <span class="at">target_columns =</span> target_columns)</span>
<span id="cb19-24"><a href="#cb19-24" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" tabindex="-1"></a><span class="co"># FIND DUPLICATES ACROSS TAGGED VARIABLES</span></span>
<span id="cb19-26"><a href="#cb19-26" tabindex="-1"></a>dups <span class="ot">&lt;-</span> <span class="fu">find_duplicates</span>(</span>
<span id="cb19-27"><a href="#cb19-27" tabindex="-1"></a>  <span class="at">data           =</span> data,</span>
<span id="cb19-28"><a href="#cb19-28" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;linelist_tags&quot;</span></span>
<span id="cb19-29"><a href="#cb19-29" tabindex="-1"></a>)</span>
<span id="cb19-30"><a href="#cb19-30" tabindex="-1"></a>Found <span class="dv">57</span> duplicated rows. Please consult the report <span class="cf">for</span> more details.</span></code></pre></div>
<p>Upon execution, the <code>find_duplicates()</code> function
identifies all duplicated rows either based on all columns or those
specified, and stores them in the report. In addition to the existing
columns, it appends two extra columns to the dataset:</p>
<ol style="list-style-type: decimal">
<li><code>row_id</code>: Contains indexes of the duplicated rows from
the original input dataset.</li>
<li><code>group_id</code>: Contains unique identifiers assigned to each
duplicated group, which is defined as a set of rows sharing identical
values in the designated columns of interest.</li>
</ol>
<p>By including these extra columns, users gain insights into the
specific rows identified as duplicates and their corresponding group
identifiers, enabling efficient analysis and management of duplicated
data within the dataset.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="co"># VISUALIZE THE DUPLICATES</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>report     <span class="ot">&lt;-</span> <span class="fu">attr</span>(dups, <span class="st">&quot;report&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>duplicates <span class="ot">&lt;-</span> report<span class="sc">$</span>duplicated_rows</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>duplicates <span class="sc">|&gt;</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>() <span class="sc">|&gt;</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_paper</span>(<span class="st">&quot;striped&quot;</span>, <span class="at">font_size =</span> <span class="dv">14</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;200px&quot;</span>, <span class="at">width =</span> <span class="st">&quot;100%&quot;</span>,</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>                         <span class="at">box_css =</span> <span class="st">&quot;border: 1px solid #ddd; padding: 5px; &quot;</span>,</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>                         <span class="at">extra_css =</span> <span class="cn">NULL</span>,</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>                         <span class="at">fixed_thead =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
row_id
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
group_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dt_onset
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dt_report
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
outcome
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2015-05-21
</td>
<td style="text-align:left;">
2015-06-03
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2015-05-21
</td>
<td style="text-align:left;">
2015-06-03
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
55
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
2015-05-30
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
2015-05-30
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
2015-05-31
</td>
<td style="text-align:left;">
2015-06-02
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Dead
</td>
</tr>
<tr>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
2015-05-31
</td>
<td style="text-align:left;">
2015-06-02
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Dead
</td>
</tr>
<tr>
<td style="text-align:right;">
99
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
2015-05-31
</td>
<td style="text-align:left;">
2015-06-09
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
2015-05-31
</td>
<td style="text-align:left;">
2015-06-09
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
2015-06-01
</td>
<td style="text-align:left;">
2015-06-03
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
2015-06-01
</td>
<td style="text-align:left;">
2015-06-03
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
2015-06-01
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
2015-06-01
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
2015-06-01
</td>
<td style="text-align:left;">
2015-06-07
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
73
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
2015-06-01
</td>
<td style="text-align:left;">
2015-06-07
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
2015-06-01
</td>
<td style="text-align:left;">
2015-06-07
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
82
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
2015-06-01
</td>
<td style="text-align:left;">
2015-06-07
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
2015-06-01
</td>
<td style="text-align:left;">
2015-06-07
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
2015-06-02
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Dead
</td>
</tr>
<tr>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
2015-06-02
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Dead
</td>
</tr>
<tr>
<td style="text-align:right;">
56
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
2015-06-02
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
58
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
2015-06-02
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
2015-06-02
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
2015-06-02
</td>
<td style="text-align:left;">
2015-06-10
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
122
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
2015-06-02
</td>
<td style="text-align:left;">
2015-06-10
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
2015-06-03
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
2015-06-03
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
2015-06-04
</td>
<td style="text-align:left;">
2015-06-07
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
2015-06-04
</td>
<td style="text-align:left;">
2015-06-07
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
2015-06-04
</td>
<td style="text-align:left;">
2015-06-07
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
2015-06-04
</td>
<td style="text-align:left;">
2015-06-07
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
102
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
2015-06-04
</td>
<td style="text-align:left;">
2015-06-09
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
2015-06-04
</td>
<td style="text-align:left;">
2015-06-09
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
96
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
2015-06-09
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
107
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
2015-06-09
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
103
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
2015-06-09
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
2015-06-09
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
2015-06-08
</td>
<td style="text-align:left;">
2015-06-12
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
133
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
2015-06-08
</td>
<td style="text-align:left;">
2015-06-12
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
2015-06-08
</td>
<td style="text-align:left;">
2015-06-12
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
129
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:left;">
2015-06-10
</td>
<td style="text-align:left;">
2015-06-12
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:left;">
2015-06-10
</td>
<td style="text-align:left;">
2015-06-12
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-06
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
69
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-07
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-07
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
91
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-08
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-08
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-10
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
121
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-10
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
155
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-16
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
161
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-16
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
156
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-16
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-16
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
158
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-16
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
159
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-16
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-16
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
<tr>
<td style="text-align:right;">
162
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2015-06-16
</td>
<td style="text-align:left;">
M
</td>
<td style="text-align:left;">
Alive
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="removing-duplicates" class="section level2">
<h2>Removing duplicates</h2>
<p>To eliminate duplicated rows from a dataset, the
<code>remove_duplicates()</code> function can be employed. This function
internally utilizes the <code>find_duplicates()</code> function and
expects the following parameters:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: A data frame or linelist from which
duplicated rows will be removed.</li>
<li><strong>target_columns</strong>: A vector containing either column
names or indices specifying the columns from which duplicated rows will
be identified. If set to <code>NULL</code>, the function will detect
duplicates across all columns. If the input dataset is a
<code>linelist</code> object, setting this parameter to
<code>linelist_tags</code> will identify duplicates across the tagged
variables only.</li>
</ol>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># REMOVE DUPLICATE ACROSS TAGGED COLUMNS ONLY.</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">remove_duplicates</span>(</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="at">data           =</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_linelist.RDS&quot;</span>,</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>                                       <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)),</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;linelist_tags&quot;</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt; Found 57 duplicated rows. Please consult the report for more details.</span></span></code></pre></div>
<p>Upon execution, the <code>remove_duplicates()</code> function returns
the input dataset without duplicated rows removed (if found). The
details about the duplicates removal operation are stored in the report
object that is attached to the output object. When duplicates are found,
this report will contain the following elements:</p>
<ul>
<li><strong>duplicated_rows</strong>: A data frame with the detected
duplicates.</li>
<li><strong>removed_duplicates</strong>: A data frame with the
duplicated rows that have been removed.</li>
<li><strong>duplicates_checked_from</strong>: A vector of column names
from which duplicates were identified.</li>
</ul>
<p>By examining these elements within the report, users gain insights
into the specific duplicated rows, those that were removed, and the
columns used to identify the duplicates, thus facilitating transparency
and documentation of the duplicates removal process.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># ACCESS THE REPORT</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>report <span class="ot">&lt;-</span> <span class="fu">attr</span>(res, <span class="st">&quot;report&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co"># SUMMARIZE THE REPORT OBJECT</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="fu">summary</span>(report)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>                        Length Class      Mode     </span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>duplicated_rows         <span class="dv">6</span>      grouped_df list     </span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>duplicates_checked_from <span class="dv">4</span>      <span class="sc">-</span>none<span class="sc">-</span>     character</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>removed_duplicates      <span class="dv">5</span>      grouped_df list     </span></code></pre></div>
<p>Use the <code>print_report()</code> function to display the report
made from this operation.</p>
<p>The output from <code>find_duplicates()</code> function can also be
passed to <code>remove_duplicates()</code> function to specify which
duplicated rows to be removed.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># DETECT DUPLICATES FROM TAGGED COLUMNS</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>dups <span class="ot">&lt;-</span> <span class="fu">find_duplicates</span>(</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="at">data           =</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_linelist.RDS&quot;</span>,</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>                                       <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)),</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;linelist_tags&quot;</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>)</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>find_and_remove_dups Found <span class="dv">57</span> duplicated rows. Please consult the report <span class="cf">for</span> more details.</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co"># EXTRACT THE DUPLICATES</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>report     <span class="ot">&lt;-</span> <span class="fu">attr</span>(dups, <span class="st">&quot;report&quot;</span>)</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>duplicates <span class="ot">&lt;-</span> report<span class="sc">$</span>duplicated_rows</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co"># REMOVE FIRST OCCURRENCE OF DUPLICATED ROWS</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>dups_index_to_remove <span class="ot">&lt;-</span> duplicates[[<span class="st">&quot;row_id&quot;</span>]][<span class="fu">seq</span>(<span class="dv">1</span><span class="dt">L</span>, <span class="fu">nrow</span>(dups), <span class="dv">2</span><span class="dt">L</span>)]</span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a>dups_index_to_remove <span class="ot">&lt;-</span> dups_index_to_remove[<span class="sc">!</span><span class="fu">is.na</span>(dups_index_to_remove)]</span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>no_dups <span class="ot">&lt;-</span> data[<span class="sc">-</span>dups_index_to_remove, ]</span></code></pre></div>
</div>
<div id="dictionary-based-data-substituting" class="section level2">
<h2>Dictionary based data substituting</h2>
<p>The <code>clean_using_dictionary()</code> function offers a
convenient way to replace the options in a data frame or linelist with
their corresponding values stored in a data dictionary. The function
expects the following arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: The input data frame or linelist that
contains the options to be replaced.</li>
<li><strong>dictionary</strong>: The data frame with the data dictionary
that contains the complete labels for these options. The structure of
this data dictionary file should adhere to the standards expected by the
<a href="https://www.repidemicsconsortium.org/matchmaker/">matchmaker</a>
package, as the <code>clean_using_dictionary()</code> function relies on
functions from this package.</li>
</ol>
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
options
</th>
<th style="text-align:left;">
values
</th>
<th style="text-align:left;">
grp
</th>
<th style="text-align:right;">
orders
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<p>The <code>add_to_dictionary()</code> function is a useful tool for
expanding the coverage of a data dictionary by defining options that are
present in the input data but not originally included in the dictionary.
This function enables users to dynamically update the dictionary to
accommodate new values encountered in the dataset. In addition to the
current data dictionary the function takes the arguments defined
below:</p>
<p><strong>option, value, grp, order</strong>: the values for the
options to be added in the data dictionary. The example below shows how
this function is used.</p>
<p>By employing the <code>add_to_dictionary()</code> function, users can
ensure that the data dictionary remains comprehensive and aligned with
the evolving nature of the input dataset, thereby enhancing the accuracy
and completeness of data interpretation and analysis. In the example
below, we add <code>-99</code> to our test data dictionary,
<code>test_dictionary</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># READING IN THE DATA</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>,</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>                            <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co"># ADD THE EXTRA OPTION TO THE DICTIONARY</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>test_dictionary <span class="ot">&lt;-</span> <span class="fu">add_to_dictionary</span>(test_dictionary,</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>                                      <span class="at">option =</span> <span class="st">&quot;-99&quot;</span>,</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>                                      <span class="at">value  =</span> <span class="st">&quot;unknow&quot;</span>,</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>                                      <span class="at">grp    =</span> <span class="st">&quot;sex&quot;</span>,</span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>                                      <span class="at">order  =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
options
</th>
<th style="text-align:left;">
values
</th>
<th style="text-align:left;">
grp
</th>
<th style="text-align:right;">
orders
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
-99
</td>
<td style="text-align:left;">
unknow
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># PERFORM THE DICTIONARY-BASED SUBSTITUTION</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>cleaned_df <span class="ot">&lt;-</span> <span class="fu">clean_using_dictionary</span>(</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  <span class="at">data       =</span> data,</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>  <span class="at">dictionary =</span> test_dictionary</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
Dec 01, 2020
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
Jan 01, 2021
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
Feb 11, 2021
</td>
<td style="text-align:left;">
unknow
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
Feb 01, 2021
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
Feb 16, 2021
</td>
<td style="text-align:left;">
female
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
-99
</td>
<td style="text-align:left;">
May 02, 2021
</td>
<td style="text-align:left;">
female
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
Feb 19, 2021
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
Sep 20, 2021
</td>
<td style="text-align:left;">
female
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
Feb 26, 2021
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
Mar 03, 2021
</td>
<td style="text-align:left;">
female
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="calculating-time-span-in-different-time-scales-years-months-weeks-or-days" class="section level2">
<h2>Calculating time span in different time scales (“years”, “months”,
“weeks”, or “days”)</h2>
<p>The <code>timespan()</code> function computes the time span between
two elements of type Date. The resulting time span can be expressed in
“years”, “months”, “weeks”, or “days”, depending on the user-specified
unit. The functions can take the following arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: The input dataset (required).</li>
<li><strong>target_column</strong>: A string with the name of the target
column (require). The values in this column are expected to be in the
form of <code>Ymd</code> i.e. <code>2024-01-31</code>. The time span
will calculated between these values and the <code>end_date</code>
defined below.</li>
<li><strong>end_date</strong>: it can be either a character that is the
name of another column of type Date from the input data or a vector of
Date values or a single Date value (required). This should also be in
the ISO8601 format (“2024-01-31”) and its default value is today’s date
<code>Sys.Date()</code>.</li>
<li><strong>span_unit</strong>: This parameter determines the unit in
which the time span is expressed (required). It can be calculated in
“years”, “months”, “weeks”, or “days”. By default, the time span is
calculated in “years” if this parameter is not provided.</li>
<li><strong>span_column_name</strong>: A string for the name of the
column added to the input data. The default is <code>span</code>.</li>
<li><strong>span_remainder_unit</strong>: A parameter used to determine
the unit in which the remainder of the time span calculation will be
returned. The possible units are: “days” or “weeks” or “months”. By
default, the function returns decimal age
i.e. <code>span_remainder_unit = NULL</code>.</li>
</ol>
<p>With these arguments, the function offers flexibility in determining
the time span in different units. It facilitates various analytics tasks
where the time span computation is a necessary component, providing
users with the ability to customize the output according to their
specific requirements.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># IMPORT DATA, REPLACE MISSING VALUES WITH &#39;NA&#39; &amp; STANDARDIZE DATES</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="fu">replace_missing_values</span>(<span class="at">target_columns =</span> <span class="st">&quot;dateOfBirth&quot;</span>,</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>                         <span class="at">na_strings     =</span> <span class="st">&quot;-99&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>  <span class="fu">standardize_dates</span>(<span class="at">target_columns  =</span> <span class="st">&quot;dateOfBirth&quot;</span>,</span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>                    <span class="at">error_tolerance =</span> <span class="fl">0.0</span>)</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="co"># CALCULATE INDIVIDUAL AGE IN YEARS FROM THE &#39;dateOfBirth&#39; COLUMN AND SEND THE</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="co"># REMAINDER IN MONTHS</span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">timespan</span>(</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>  <span class="at">data                =</span> data,</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>  <span class="at">target_column       =</span> <span class="st">&quot;dateOfBirth&quot;</span>,</span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>  <span class="at">end_date            =</span> <span class="fu">Sys.Date</span>(),</span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>  <span class="at">span_unit           =</span> <span class="st">&quot;years&quot;</span>,</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>  <span class="at">span_column_name    =</span> <span class="st">&quot;age_in_years&quot;</span>,</span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>  <span class="at">span_remainder_unit =</span> <span class="st">&quot;months&quot;</span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a>)</span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="co"># CALCULATE THE TIME SPAN IN YEARS BETWEEN INDIVIDUALS &#39;dateOfBirth&#39; AND THE DAY</span></span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a><span class="co"># THEY TESTED POSITIVE</span></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a>  <span class="fu">replace_missing_values</span>(<span class="at">target_columns =</span> <span class="st">&quot;dateOfBirth&quot;</span>,</span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a>                         <span class="at">na_strings     =</span> <span class="st">&quot;-99&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a>  <span class="fu">standardize_dates</span>(</span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a>    <span class="at">target_columns  =</span> <span class="fu">c</span>(<span class="st">&quot;dateOfBirth&quot;</span>, <span class="st">&quot;date_first_pcr_positive_test&quot;</span>),</span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a>    <span class="at">error_tolerance =</span> <span class="fl">0.0</span></span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb26-28"><a href="#cb26-28" tabindex="-1"></a>  <span class="fu">timespan</span>(</span>
<span id="cb26-29"><a href="#cb26-29" tabindex="-1"></a>    <span class="at">target_column       =</span> <span class="st">&quot;dateOfBirth&quot;</span>,</span>
<span id="cb26-30"><a href="#cb26-30" tabindex="-1"></a>    <span class="at">end_date            =</span> <span class="st">&quot;date_first_pcr_positive_test&quot;</span>,</span>
<span id="cb26-31"><a href="#cb26-31" tabindex="-1"></a>    <span class="at">span_unit           =</span> <span class="st">&quot;years&quot;</span>,</span>
<span id="cb26-32"><a href="#cb26-32" tabindex="-1"></a>    <span class="at">span_column_name    =</span> <span class="st">&quot;elapsed_time&quot;</span>,</span>
<span id="cb26-33"><a href="#cb26-33" tabindex="-1"></a>    <span class="at">span_remainder_unit =</span> <span class="cn">NULL</span></span>
<span id="cb26-34"><a href="#cb26-34" tabindex="-1"></a>  )</span></code></pre></div>
<p>The <code>timespan()</code> function augments the input dataset by
adding one or two extra columns containing age-related information.
These additional columns are as follows:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Calculated time span in the specified scale</strong>:
Contains the calculated time span in the specified unit (“years”,
“months”, “weeks”, or “days”).</p></li>
<li><p><strong>Remaining number of days</strong>: Indicates the
remaining number of “days” or “weeks” or “months” after calculating the
time span, representing the fractional part of the time span
calculation. This column is included if needed, and provides additional
granularity in the time span representation.</p></li>
</ol>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
elapsed_time
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
1972-01-06
</td>
<td style="text-align:left;">
2020-12-01
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
48.90349
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
1952-02-20
</td>
<td style="text-align:left;">
2021-01-01
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
68.86516
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
1961-06-15
</td>
<td style="text-align:left;">
2021-02-11
</td>
<td style="text-align:right;">
-99
</td>
<td style="text-align:right;">
59.66051
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
1947-11-11
</td>
<td style="text-align:left;">
2021-02-01
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
73.22656
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
2000-09-26
</td>
<td style="text-align:left;">
2021-02-16
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
20.39151
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2021-05-02
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
1989-03-11
</td>
<td style="text-align:left;">
2021-02-19
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
31.94524
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
1976-05-10
</td>
<td style="text-align:left;">
2021-09-20
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
45.36345
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
1991-09-23
</td>
<td style="text-align:left;">
2021-02-26
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
29.42916
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
1991-08-02
</td>
<td style="text-align:left;">
2021-03-03
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
29.58522
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="printing-the-report" class="section level2">
<h2>Printing the report</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">print_report</span>(</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>  <span class="at">data             =</span> data,</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  <span class="at">report_title     =</span> <span class="st">&quot;{cleanepi} data cleaning report&quot;</span>,</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>  <span class="at">output_directory =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>  <span class="at">output_filename  =</span> <span class="st">&quot;cleaning_report&quot;</span>,</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>  <span class="at">format           =</span> <span class="st">&quot;html&quot;</span>,</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>  <span class="at">print            =</span> <span class="cn">TRUE</span></span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
