<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Standardize date variables — standardize_dates • cleanepi</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Standardize date variables — standardize_dates"><meta name="description" content="When the format of the values in a column and/or the target columns are not
defined, we strongly recommend checking a few converted dates manually to
make sure that the dates extracted from a character vector or a factor
are correct."><meta property="og:description" content="When the format of the values in a column and/or the target columns are not
defined, we strongly recommend checking a few converted dates manually to
make sure that the dates extracted from a character vector or a factor
are correct."><meta property="og:image" content="https://epiverse-trace.github.io/cleanepi/logo.svg"><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="https://epiverse-trace.github.io/blueprints/logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">cleanepi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/cleanepi.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/design_principle.html">Package Design vignette for {cleanepi}</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiverse-trace/cleanepi/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Standardize date variables</h1>
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/cleanepi/blob/main/R/standardize_date.R" class="external-link"><code>R/standardize_date.R</code></a></small>
      <div class="d-none name"><code>standardize_dates.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>When the format of the values in a column and/or the target columns are not
defined, we strongly recommend checking a few converted dates manually to
make sure that the dates extracted from a <code>character</code> vector or a <code>factor</code>
are correct.<br></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">standardize_dates</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  target_columns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  format <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  timeframe <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  error_tolerance <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  orders <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The input <code>&lt;data.frame&gt;</code> or <code>&lt;linelist&gt;</code></p></dd>


<dt id="arg-target-columns">target_columns<a class="anchor" aria-label="anchor" href="#arg-target-columns"></a></dt>
<dd><p>A <code>&lt;vector&gt;</code> of the target date column names. When
the input data is a <code>&lt;linelist&gt;</code> object, this parameter can be set to
<code>linelist_tags</code> if you wish to standardize the date columns across
tagged columns only. Default is <code>NULL</code>.</p></dd>


<dt id="arg-format">format<a class="anchor" aria-label="anchor" href="#arg-format"></a></dt>
<dd><p>A <code>&lt;vector&gt;</code> of the expected formats in the date values
from the date columns. Default is <code>NULL</code>.</p></dd>


<dt id="arg-timeframe">timeframe<a class="anchor" aria-label="anchor" href="#arg-timeframe"></a></dt>
<dd><p>A <code>&lt;vector&gt;</code> of 2 values of type <code>&lt;Date&gt;</code>. If
provided, date values that do not fall within this timeframe will be set
to <code>NA</code>.</p></dd>


<dt id="arg-error-tolerance">error_tolerance<a class="anchor" aria-label="anchor" href="#arg-error-tolerance"></a></dt>
<dd><p>A <code>&lt;numeric&gt;</code> between 0 and 1 indicating the
proportion of entries which cannot be identified as dates to be tolerated;
if this proportion is exceeded, the original vector is returned, and a
message is issued; defaults to 0.4 (40 percent).</p></dd>


<dt id="arg-orders">orders<a class="anchor" aria-label="anchor" href="#arg-orders"></a></dt>
<dd><p>A <code>&lt;list&gt;</code> or <code>&lt;vector&gt;</code> of characters with the date
codes for fine-grained parsing of dates. This allows for parsing of mixed
dates. If a <code>&lt;list&gt;</code> is supplied, that <code>&lt;list&gt;</code> will be used for
successive tries in parsing. When this is not provided
(<code>orders = NULL</code>), the function will use the following order defined
in the guesser:</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="at">quarter_partial_dates =</span> <span class="fu">c</span>(<span class="st">"Y"</span>, <span class="st">"Ym"</span>, <span class="st">"Yq"</span>),</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="at">world_digit_months =</span> <span class="fu">c</span>(<span class="st">"Yq"</span>, <span class="st">"ymd"</span>, <span class="st">"ydm"</span>, <span class="st">"dmy"</span>, <span class="st">"mdy"</span>, <span class="st">"myd"</span>, <span class="st">"dym"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>                         <span class="st">"Ymd"</span>, <span class="st">"Ydm"</span>, <span class="st">"dmY"</span>, <span class="st">"mdY"</span>, <span class="st">"mYd"</span>, <span class="st">"dYm"</span>),</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="at">world_named_months =</span> <span class="fu">c</span>(<span class="st">"dby"</span>, <span class="st">"dyb"</span>, <span class="st">"bdy"</span>, <span class="st">"byd"</span>, <span class="st">"ybd"</span>, <span class="st">"ydb"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>                         <span class="st">"dbY"</span>, <span class="st">"dYb"</span>, <span class="st">"bdY"</span>, <span class="st">"bYd"</span>, <span class="st">"Ybd"</span>, <span class="st">"Ydb"</span>),</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="at">us_format =</span> <span class="fu">c</span>(<span class="st">"Omdy"</span>, <span class="st">"YOmd"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>)</span></code></pre><p></p></div></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The input dataset where the date columns have been standardized. The
date values that are out of the specified timeframe will be reported in
the report. Similarly, date values that comply with multiple formats will
also be featured in the report object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Check for the presence of date values that could have multiple formats
from the <code>$multi_format_dates</code> element of the <code>report</code>.<br></p>
<p>Converting ambiguous character strings to dates is difficult for
many reasons:</p><ul><li><p>dates may not use the standard Ymd format</p></li>
<li><p>within the same variable, dates may follow different formats</p></li>
<li><p>dates may be mixed with things that are not dates</p></li>
<li><p>the behavior of <code>as.Date</code> in the presence of non-date is hard to predict,
sometimes returning <code>NA</code>, sometimes issuing an error.</p></li>
</ul><p>This function tries to address all the above issues. Dates with the following
format should be automatically detected, irrespective of separators
(e.g. "-", " ", "/") and surrounding text:</p><ul><li><p>"19 09 2018"</p></li>
<li><p>"2018 09 19"</p></li>
<li><p>"19 Sep 2018"</p></li>
<li><p>"2018 Sep 19"</p></li>
<li><p>"Sep 19 2018"</p></li>
</ul><div class="section">
<h3 id="how-it-works">How it works<a class="anchor" aria-label="anchor" href="#how-it-works"></a></h3>


<p>This function relies heavily on <code><a href="https://lubridate.tidyverse.org/reference/parse_date_time.html" class="external-link">lubridate::parse_date_time()</a></code>, which is an
extremely flexible date parser that works well for consistent date formats,
but can quickly become unwieldy and may produce spurious results.
<code>standardize_dates()</code> will use a list of formats in the <code>orders</code> argument to
run <code>parse_date_time()</code> with each format vector separately and take the first
correctly parsed date from all the trials.</p>
<p>With the default orders shown above, the dates 03 Jan 2018, 07/03/1982, and
08/20/85 are correctly interpreted as 2018-01-03, 1982-03-07, and 1985-08-20.
The examples section will show how you can manipulate the <code>orders</code> to be
customized for your situation.</p>
</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"03 Jan 2018"</span>, <span class="st">"07/03/1982"</span>, <span class="st">"08/20/85"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># The below will coerce values where the month is written in letters only</span></span></span>
<span class="r-in"><span><span class="co"># into Date.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/parse_date_time.html" class="external-link">parse_date_time</a></span><span class="op">(</span><span class="va">x</span>, orders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ybd"</span>, <span class="st">"dby"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span> 2 failed to parse.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2018-01-03" NA           NA          </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># coerce values where the month is written in letters or numbers into Date.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/parse_date_time.html" class="external-link">parse_date_time</a></span><span class="op">(</span><span class="va">x</span>, orders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dmy"</span>, <span class="st">"Ymd"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span> 1 failed to parse.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2018-01-03" "1982-03-07" NA          </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># How to use standardize_dates()</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">standardize_dates</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"test_df.RDS"</span>, package <span class="op">=</span> <span class="st">"cleanepi"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  target_columns <span class="op">=</span> <span class="st">"date_first_pcr_positive_test"</span>,</span></span>
<span class="r-in"><span>  format <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  timeframe <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  error_tolerance <span class="op">=</span> <span class="fl">0.4</span>,</span></span>
<span class="r-in"><span>  orders <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    world_named_months <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ybd"</span>, <span class="st">"dby"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    world_digit_months <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dmy"</span>, <span class="st">"Ymd"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    US_format <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Omdy"</span>, <span class="st">"YOmd"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Karim Mané, Abdoelnaser Degoot, Bankolé Ahadzie, Nuredin Mohammed, Bubacarr Bah, data.org.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

